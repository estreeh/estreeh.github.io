(this["webpackJsonpestreeh-web-agencies-frontend"]=this["webpackJsonpestreeh-web-agencies-frontend"]||[]).push([[0],{1855:function(e,t,a){},1856:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),r=a(15),s=a.n(r),c=(a(236),a(1910)),o=(a(237),a(147)),l=a(192),d=a(75),u=a.n(d),j="#B3D9E3",h="#E6F1F4",b={primary:"#5890A7",light:j,lighter:"#D9E5EA",lightest:h,lightBg:"#f8f8f8",warning:"#ffd294",dark:"#172C42",slotColors:{free:"#a0ffae",booked:"#ff929c",off:"#dfdfdf",hover:j,selected:h,shadowColor:function(e){return new u.a(e).darken(.5).alpha(.5).toString()},shadow:function(e,t,a){var i=t||1;return i+"px "+i+"px "+(a||2)+"px "+new u.a(e).darken(.5).alpha(.5).toString()}},slotColorsDot:{free:"#50af56",booked:"#ea1542",off:"#dfdfdf"},text:{primary:"#000000",secondary:"#777777",warning:u()("#ffd294").darken(.45).string()},fontSize:{small:13},fontFamily:{heading:"",body:'"Roboto", "Segoe UI", "Helvetica", "Arial", open_sansregular,Helvetica Neue,Helvetica,-apple-system, BlinkMacSystemFont, "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif'},shadow:{niceShadow:"0 0 25px #00000011"},borderRadius:{niceRadius:10},transition:"all 0.1s"},m=Object(o.a)((function(e){return Object(l.a)({root:{flexGrow:1,"& a":{color:b.primary},"& .material-icons":{verticalAlign:"text-bottom"},"& .transitionDefault":{transition:b.transition},"& .MuiTextField-root":{marginTop:e.spacing(.5),marginBottom:e.spacing(.5),width:"100%"},"& .MuiAvatar-img":{objectFit:"contain"},"& .notched-outline-no-border":{borderTop:0,borderRight:0,borderBottom:0}},objectFitContain:{"& .MuiAvatar-img":{objectFit:"contain"}},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.primary},transitionDefault:{transition:b.transition},wizardCardLink:{display:"block",color:"#000",borderRadius:10,boxShadow:"0 0 22px #00000022",background:"white",textDecoration:"none",transition:b.transition,"&:hover":{background:b.lightest,boxShadow:"0 0 2px "+b.primary}},hoverBox:{transition:b.transition,userSelect:"none","&:hover":{backgroundColor:b.lightBg}}})})),f=a(70),x=Object(f.a)({palette:{primary:{main:b.primary},secondary:{main:b.warning},contrastThreshold:3,tonalOffset:.2},typography:{fontFamily:b.fontFamily.body}}),p=a(5),O=a(34),g=a(1911),v=a(1897),y=a(1913),k=a(130),w=a(20),S=a.n(w),F=a(1);function C(e){return Object(F.jsxs)(g.a,{mb:2,children:[Object(F.jsx)(k.a,{variant:"h4",children:e.title}),Object(F.jsx)(k.a,{variant:"h5",style:{color:b.text.secondary},children:e.children})]})}var M=a(1898);function T(e){return Object(F.jsx)(v.a,{item:!0,md:3,xs:12,children:Object(F.jsxs)(g.a,{bgcolor:b.lighter,p:3,borderRadius:b.borderRadius.niceRadius,boxShadow:b.shadow.niceShadow,textAlign:"center",children:[Object(F.jsx)(g.a,{pb:2,children:Object(F.jsx)(k.a,{style:{textTransform:"uppercase"},children:e.title})}),Object(F.jsxs)(g.a,{pb:2,fontSize:"3.5rem",children:[void 0===e.value&&Object(F.jsx)(M.a,{variant:"text",width:120,animation:"wave",style:{marginLeft:"auto",marginRight:"auto"}}),void 0!==e.value&&Object(F.jsx)(g.a,{children:e.value})]})]})})}function P(e){var t=Object(i.useState)(void 0),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(null),c=Object(p.a)(s,2),o=c[0],l=c[1];return Object(i.useEffect)((function(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/dashboard",{withCredentials:!0}).then((function(e){r(e.data.data),console.log("Got dashboard summary",e.data.data)})),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency",{withCredentials:!0}).then((function(e){l(e.data.data),console.log("Got agency")}))}),[r]),Object(F.jsx)(g.a,{children:Object(F.jsxs)(v.a,{container:!0,direction:"row-reverse",spacing:2,children:[Object(F.jsx)(v.a,{item:!0,md:3,xs:12,children:Object(F.jsxs)(g.a,{textAlign:"center",children:[Object(F.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net/agency/sm/"+(null===o||void 0===o?void 0:o._id)+"."+(null===o||void 0===o?void 0:o.logoFileExt),variant:"rounded",style:{width:260,height:220,marginLeft:"auto",marginRight:"auto"}}),Object(F.jsx)(k.a,{children:null===o||void 0===o?void 0:o.title}),Object(F.jsx)(k.a,{children:null===o||void 0===o?void 0:o.titleAr}),Object(F.jsxs)(k.a,{children:["CR: ",null===o||void 0===o?void 0:o.cr]})]})}),Object(F.jsxs)(v.a,{item:!0,md:9,xs:12,children:[Object(F.jsx)(C,{title:"Welcome, ".concat(e.user.fullName)}),Object(F.jsx)(k.a,{children:"Welcome to the Estreeh agency portal."}),Object(F.jsx)(k.a,{children:"Please use the left menu to navigate."}),Object(F.jsx)(g.a,{p:3,children:Object(F.jsxs)(v.a,{container:!0,spacing:2,alignItems:"center",children:[Object(F.jsx)(T,{title:"New Requests",value:null===n||void 0===n?void 0:n.newRequests}),Object(F.jsx)(T,{title:"Pending Requests",value:null===n||void 0===n?void 0:n.pendingRequests}),Object(F.jsx)(T,{title:"My Workers",value:null===n||void 0===n?void 0:n.myWorkers}),Object(F.jsx)(T,{title:"Customer Reviews",value:null===n||void 0===n?void 0:n.customerReviews})]})})]})]})})}var R=a(23),A=a.p+"static/media/logo.d1016dba.svg";function q(e){return Object(F.jsx)("img",{src:A,style:Object(R.a)({display:"block",maxWidth:"100%",margin:"0",maxHeight:40},e.styles),alt:"Estreeh Logo"})}var B=a(1899),I=a(1900);function L(e){var t,a=e.navItem,i={display:"block",color:"white",padding:"2px 8px",textDecoration:"none"},n=Object(F.jsxs)(g.a,{children:[a.icon&&Object(F.jsx)(B.a,{fontSize:"small",style:{marginRight:6},children:a.icon}),a.title]});return Object(F.jsxs)(g.a,{ml:e.mx,my:e.my,children:[a.to&&Object(F.jsx)(O.a,{style:Object(R.a)({},i),to:a.to,children:n}),!a.to&&Object(F.jsx)(I.a,{href:"#",style:Object(R.a)({},i),children:n}),void 0!==e.navItem.children&&Object(F.jsx)(g.a,{fontSize:"90%",children:null===(t=e.navItem.children)||void 0===t?void 0:t.map((function(e){return Object(F.jsx)(L,{my:.5,mx:5,navItem:e},e.title+"_"+e.to)}))})]})}function N(e){return Object(F.jsx)(g.a,{position:"fixed",width:"16.6666667%",height:"100%",children:Object(F.jsxs)(g.a,{bgcolor:b.primary,color:"white",height:"100%",children:[Object(F.jsx)(g.a,{p:2,bgcolor:b.lighter,textAlign:"left",children:Object(F.jsx)(O.a,{to:"/panel",style:{display:"inline-block"},children:Object(F.jsx)(q,{})})}),Object(F.jsx)(g.a,{px:0,py:4,children:[{key:"dash1",title:"Dashboard",to:"/panel/dashboard",icon:"arrow_forward_ios"},{key:"myrequests",title:"My Requests",to:"/panel/my-requests",icon:"arrow_forward_ios"},{key:"myworkers",title:"My Workers",to:"/panel/my-workers",icon:"arrow_forward_ios",children:[{key:"mw-manageworkers",title:"Manage Workers",to:"/panel/my-workers"},{key:"mw-addnewworker",title:"Add New Worker",to:"/panel/my-workers/add"}]},{key:"agencysettings",title:"Agency Settings",icon:"arrow_forward_ios",children:[{key:"as-settings",title:"General Settings",to:"/panel/agency/settings"},{key:"as-processes",title:"Process Templates",to:"/panel/agency/settings/process-templates"},{key:"as-qr",title:"QR Code"}]}].map((function(e){return Object(F.jsx)(L,{my:2,mx:1,navItem:e},e.title+"_"+e.to)}))})]})})}var D=a(60);function _(e){var t=u()(b.lightBg).alpha(.8).string(),a={lineHeight:"40px"};return Object(F.jsx)(g.a,{position:"fixed",top:0,right:0,left:"16.66667%",zIndex:1e3,children:Object(F.jsx)(g.a,{p:2,bgcolor:t,children:Object(F.jsx)(v.a,{container:!0,spacing:3,direction:"row-reverse",children:Object(F.jsx)(v.a,{item:!0,children:Object(F.jsx)(g.a,{children:Object(F.jsxs)(v.a,{container:!0,spacing:1,children:[Object(F.jsxs)(v.a,{item:!0,style:a,children:["Welcome ",e.user.fullName]}),Object(F.jsx)(v.a,{item:!0,style:a,children:Object(F.jsx)(D.a,{color:"primary",onClick:function(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/auth/logout",{withCredentials:!0}).then((function(t){e.setUser(void 0),Object(O.d)("/login")}))},children:"Logout"})}),Object(F.jsx)(v.a,{item:!0,children:Object(F.jsx)(y.a,{})})]})})})})})})}function E(e){return Object(F.jsx)(g.a,{height:"100%",children:Object(F.jsx)(v.a,{container:!0,direction:"column",style:{height:"100%"},children:Object(F.jsx)(v.a,{item:!0,xs:12,children:Object(F.jsxs)(v.a,{container:!0,alignItems:"stretch",style:{height:"100%"},children:[Object(F.jsx)(v.a,{item:!0,md:2,xs:2,children:Object(F.jsx)(N,{})}),Object(F.jsxs)(v.a,{item:!0,md:10,xs:10,children:[Object(F.jsx)(_,{user:e.user,setUser:e.setUser}),Object(F.jsx)(g.a,{px:2,pb:2,pt:12,children:e.children})]})]})})})})}function W(e){return Object(F.jsx)(F.Fragment,{children:e.children})}var z=a(32),U=a(1902),V=a(1901);function H(e){var t=Object(z.a)(),a=Object(V.a)(t.breakpoints.up("md")),i=a?"right":"bottom";return Object(F.jsxs)(v.a,{container:!0,children:[Object(F.jsx)(v.a,{item:!0,md:5,xs:12,children:Object(F.jsx)(g.a,{px:4,bgcolor:b.lightest,style:{backgroundImage:"linear-gradient(to ".concat(i,", ").concat(b.lightest," 75%, ").concat("#fff",")")},height:a?"100vh":void 0,children:Object(F.jsxs)(g.a,{py:a?6:3,style:{textShadow:"0 0 8px #ffffff"},children:[Object(F.jsx)(q,{styles:{maxHeight:a?120:50,marginBottom:24}}),Object(F.jsx)(k.a,{variant:a?"h4":"h5",children:"Estreeh Management Portal"}),Object(F.jsx)(k.a,{children:"Please login to access your management portal."})]})})}),Object(F.jsx)(v.a,{item:!0,md:7,xs:12,children:Object(F.jsxs)(U.a,{children:[a&&Object(F.jsx)(g.a,{py:4,children:Object(F.jsx)(q,{styles:{maxHeight:50,margin:"0 auto"}})}),Object(F.jsx)(g.a,{children:e.children})]})})]})}function G(e){return Object(F.jsx)(U.a,{children:Object(F.jsxs)(g.a,{m:5,p:3,boxShadow:b.shadow.niceShadow,children:[Object(F.jsx)(k.a,{variant:"h1",children:e.title}),Object(F.jsx)(k.a,{variant:"h5",children:e.subtitle}),Object(F.jsxs)(g.a,{py:2,children:[Object(F.jsx)(g.a,{mb:1,children:e.children}),Object(F.jsx)(g.a,{children:Object(F.jsx)(k.a,{children:Object(F.jsx)(I.a,{href:"/",children:"Back to homepage."})})})]})]})})}function Y(e){return Object(F.jsx)(G,{title:"404",subtitle:"\ud83e\udd28 Page not found",children:Object(F.jsx)(k.a,{children:"Sorry but the page you're looking for cannot be found. Please double check the link you have entered."})})}var J=a(135),K=a(1860),X=a(214);function Q(e){var t=Object(i.useState)(!1),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(""),c=Object(p.a)(s,2),o=c[0],l=c[1],d=Object(i.useState)(""),u=Object(p.a)(d,2),j=u[0],h=u[1],m=["Agency","Agency Manager"],f=function(e){r(!1),void 0!==e&&console.log("Login error:",e)};return Object(F.jsx)(g.a,{children:Object(F.jsx)(g.a,{p:3,maxWidth:440,marginLeft:"auto",marginRight:"auto",my:5,boxShadow:b.shadow.niceShadow,borderRadius:b.borderRadius.niceRadius,children:Object(F.jsxs)("form",{children:[Object(F.jsx)(J.a,{id:"username",label:"Email",variant:"outlined",value:j,onChange:function(e){return h(e.target.value)}}),Object(F.jsx)(J.a,{id:"username",label:"Password",variant:"outlined",type:"password",value:o,onChange:function(e){return l(e.target.value)}}),Object(F.jsx)(g.a,{py:0,children:Object(F.jsxs)(v.a,{container:!0,spacing:1,children:[Object(F.jsx)(v.a,{item:!0,xs:6,children:Object(F.jsx)(K.a,{control:Object(F.jsx)(X.a,{name:"checkedB",color:"primary",size:"small"}),label:"Keep me Logged In"})}),Object(F.jsx)(v.a,{item:!0,xs:6,children:Object(F.jsx)(g.a,{textAlign:"right",children:Object(F.jsx)(O.a,{to:"reset-password",children:Object(F.jsx)(g.a,{lineHeight:"38px",children:"Forgot password?"})})})})]})}),Object(F.jsx)(g.a,{py:3,textAlign:"center",children:Object(F.jsx)(D.a,{disabled:n,variant:"contained",color:"primary",onClick:function(){r(!0);var t={email:j,password:o};S.a.post("https://estreeh-dev-apis.herokuapp.com/api/v1/auth/login",t,{withCredentials:!0}).then((function(t){var a=t.data.data;void 0!==a&&void 0!==a.agencyId&&m.includes(a.role)?e.getUser().then((function(t){e.setUser(t.data.data),Object(O.d)("/")})).finally((function(){f()})):f("User is not authorized to use this platform.")})).catch((function(e){f(e)}))},children:"Login"})})]})})})}var Z=a(128),$=a.n(Z),ee=a(198),te=a(56),ae=a(16),ie=a(38),ne=a(1905),re=a(61),se=a(1861);function ce(e){var t=e.field.name.toString(),a=Object(i.useMemo)((function(){return void 0!==e.field.label?e.field.label:oe(t)}),[e.field.label,t]),n="field_"+t,r=void 0!==e.field.type?e.field.type:"text",s=void 0!==e.field.variant?e.field.variant:"text",c=void 0!==e.defaultXs?e.defaultXs:12,o=void 0!==e.defaultMd?e.defaultMd:4,l=void 0!==e.field.xs?e.field.xs:c,d=void 0!==e.field.md?e.field.md:o,u=void 0!==e.size?e.size:"medium",j=Object(i.useMemo)((function(){return{shrink:!0}}),[]),h=(e.field.readOnly,"outlined"),b="textarea"===e.field.variant?3:void 0,m=void 0!==e.field.textareaLines?e.field.textareaLines:b,f=void 0!==e.field.numberMinimum?e.field.numberMinimum:0,x=Object(i.useMemo)((function(){return e.field.onChange?e.field.onChange:function(){}}),[e.field.onChange]),p=Object(i.useMemo)((function(){return void 0!==e.field.prefix?Object(F.jsx)(ne.a,{position:"start",children:e.field.prefix}):void 0}),[e.field.prefix]),O=Object(i.useMemo)((function(){return void 0!==e.field.suffix?Object(F.jsx)(ne.a,{position:"end",children:e.field.suffix}):void 0}),[e.field.suffix]),g=Object(i.useMemo)((function(){return void 0!==e.formik?e.formik.getFieldProps(t):{onChange:x,name:t,value:e.field.value,checked:e.field.value,onBlur:function(){}}}),[x,t,e.field.value,e.formik]),y=void 0!==e.formik&&e.formik.touched[t]&&void 0!==e.formik.errors[t],k=void 0!==e.formik&&e.formik.touched[t]&&e.formik.errors[t],w=Object(i.useMemo)((function(){return"select"===e.field.variant?e.field.selectOptions.length>0?e.field.selectOptions:[]:void 0}),[e.field]),S=Object(i.useMemo)((function(){return void 0!==w&&w.map((function(e){var t=void 0!==e.title?e.title:oe(e.value);return Object(F.jsx)(re.a,{value:e.value,children:t},"opt_"+e.value)}))}),[w]),C=Object(i.useMemo)((function(){return"switch"===s?Object(F.jsx)(se.a,Object(R.a)({color:"primary"},g)):Object(F.jsx)(X.a,Object(R.a)({color:"primary"},g))}),[g,s]),M=Object(i.useMemo)((function(){return Object(F.jsxs)(F.Fragment,{children:[("file"!==s&&"switch"!==s&&"checkbox"!==s&&"select"!==e.field.variant||"select"===e.field.variant&&void 0!==w&&(null===w||void 0===w?void 0:w.length)>0)&&Object(F.jsx)(J.a,Object(R.a)(Object(R.a)({id:n,color:"primary",variant:h,type:e.field.type,label:a+(void 0===e.formik?" [UNBOUND]":""),size:u,select:"select"===s,multiline:"textarea"===s,rows:m,InputLabelProps:"date"===r?j:void 0,disabled:e.field.disabled||e.disabled,inputProps:{min:f,step:e.field.step},InputProps:{startAdornment:p,endAdornment:O,readOnly:e.field.readOnly,classes:e.field.readOnly?{notchedOutline:"notched-outline-no-border"}:void 0},error:y,helperText:k},g),{},{children:S})),("switch"===s||"checkbox"===s)&&Object(F.jsx)(K.a,Object(R.a)({control:C,label:a},g)),"file"===s&&Object(F.jsxs)(D.a,{variant:"contained",component:"label",children:[void 0!==e.field.buttonIcon&&Object(F.jsx)(B.a,{style:{marginRight:8},children:e.field.buttonIcon}),a,Object(F.jsx)("input",{type:"file",id:n,name:t,hidden:!0,onChange:function(a){if(null!==a.currentTarget.files){var i=a.currentTarget.files[0];void 0!==e.formik&&(console.log(i),e.formik.setFieldValue(t,i))}}})]}),"file"===s&&!1]})}),[C,y,g,h,k,n,a,j,S,t,f,p,e.disabled,e.field.avatarWidth,e.field.buttonIcon,e.field.disabled,e.field.readOnly,e.field.step,e.field.type,e.field.variant,e.formik,m,w,u,O,r,s]);return Object(F.jsx)(v.a,{item:!0,xs:l,md:d,children:M})}function oe(e){if(void 0!==e){var t=("string"===typeof e?e:e.toString()).replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}throw new Error("Text is undefined")}function le(e){var t=void 0!==e.variant?e.variant:"normal",a="small"===t,i="normal"===t;return Object(F.jsx)(F.Fragment,{children:e.header&&Object(F.jsx)(g.a,{py:a?1:2,children:Object(F.jsx)(k.a,{variant:i?"h6":void 0,children:e.header})})})}function de(e){return Object(F.jsxs)(g.a,{children:[Object(F.jsx)(le,{header:e.header,variant:e.headerVariant}),Object(F.jsx)(g.a,{mb:2,children:Object(F.jsx)(k.a,{color:"primary",children:e.helpText})}),Object(F.jsxs)(v.a,{container:!0,spacing:2,alignItems:"center",children:[void 0!==e.fields&&e.fields.map((function(t){return Object(F.jsx)(ce,{formik:e.formik,field:t,defaultMd:e.md,defaultXs:e.xs,size:"small",disabled:e.disabled},t.name.toString())})),void 0!==e.children&&Object(F.jsx)(v.a,{item:!0,xs:e.xs,md:e.md,children:e.children})]})]})}var ue=a(90),je=a.n(ue),he=["House Maid","Nanny","Driver","Chef","Farmer"],be=([{fullTitle:"Lease hourly",title:"By Hour",isRentalHourly:!0,feesBhdUnit:"Hour",feesBhd:2},{fullTitle:"Lease monthly",title:"Full Month",isRentalMonthly:!0,feesBhd:10*je.a.random.number({min:15,max:35}),feesBhdUnit:"Month"}].map((function(e){return e.fullTitle})),a(1907)),me=a(1906);function fe(e){var t=[];if(Object.keys(e.errors).length>0)for(var a in e.errors)t.push({key:a,value:e.errors[a]});return Object(F.jsx)("ul",{style:{margin:0,padding:0},children:t.map((function(t){return Object(F.jsxs)("li",{style:Object(R.a)({listStylePosition:"inside",color:"red",fontSize:11},e.style),children:[Object(F.jsx)("strong",{children:t.key})," ",t.value]})}))})}function xe(e){var t=void 0!==e.navigateUrl?e.navigateUrl:"success";return Object(F.jsxs)(g.a,{children:[Object(F.jsx)(g.a,{my:3,children:Object(F.jsx)(me.a,{})}),Object(F.jsxs)(g.a,{my:3,textAlign:"right",maxWidth:160,marginLeft:"auto",children:[void 0!==e.errors&&Object(F.jsx)(g.a,{my:3,children:Object(F.jsx)(fe,{errors:e.errors})}),Object(F.jsx)(D.a,{fullWidth:!0,variant:"contained",color:"primary",type:e.type,onClick:function(){e.navigate&&e.navigate(t)},disabled:e.disabled,children:e.title})]})]})}var pe=["Philippines","Indonesia","India","Sri Lanka","Ethiopia","Kenya","Ghana"];function Oe(e){var t=e.formik,a=e.disabled,i=e.id,n=e.worker,r=e.templateFields,s="https://d15f7urgawp38o.cloudfront.net/2y/sm/"+n._id+"."+n.smallPictureFileExt,c="https://d15f7urgawp38o.cloudfront.net/2y/lg/"+n._id+"."+n.bigPictureFileExt,o=[{name:"name"},{name:"referenceId"},{name:"jobTitle",variant:"select",selectOptions:he.map((function(e){return{value:e}}))},{name:"monthlySalary"},{name:"contractPeriod"},{name:"phone"},{name:"isLocalTransfer",variant:"checkbox"}],l=[{name:"nationality",variant:"select",selectOptions:pe.map((function(e){return{value:e}}))},{name:"experienceYears",type:"number"},{name:"educationalLevel"},{name:"dateOfBirth",type:"date"},{name:"maritalStatus",variant:"select",selectOptions:[{value:"Single"},{value:"Married"}]},{name:"age",type:"number"},{name:"weightKg"},{name:"complexion"},{name:"religion"},{name:"numberOfChildren",type:"number"},{name:"heightCm"},{name:"remarks",variant:"textarea",md:9}],d=[{value:"Poor"},{value:"Fair"},{value:"Fluent"}],u=[{name:"languageSkillEnglish",variant:"select",selectOptions:d},{name:"languageSkillArabic",variant:"select",selectOptions:d}];function j(){alert("To change picture please use the Upload Picture buttons near the end of this page.")}return Object(F.jsxs)("form",{onSubmit:t.handleSubmit,children:[Object(F.jsxs)(v.a,{container:!0,spacing:2,children:[Object(F.jsx)(v.a,{item:!0,children:Object(F.jsx)(y.a,{src:s,variant:"rounded",style:{width:90,height:90,cursor:"help"},onClick:j})}),Object(F.jsx)(v.a,{item:!0,xs:9,children:Object(F.jsx)(C,{title:void 0===i?"Add a New Worker":"Edit Worker: "+n.name})})]}),Object(F.jsx)(de,{fields:o,header:"Main Information",formik:t,disabled:a}),Object(F.jsx)(de,{fields:[{name:"localTransferReason",variant:"textarea"}],md:7,formik:t,disabled:a}),Object(F.jsx)(de,{fields:r,header:"Process Template",disabled:a}),Object(F.jsx)(de,{fields:l,header:"Personal Details",formik:t,disabled:a}),Object(F.jsx)(de,{fields:u,header:"Language Skills",formik:t,disabled:a}),Object(F.jsx)(de,{header:"Skills",xs:12,formik:t,disabled:a,children:Object(F.jsx)(be.a,{row:!0,children:["Baby Sitting","Cooking","Nursing","Elder Caring","Washing","Ironing"].map((function(e){return Object(F.jsx)(K.a,{control:Object(F.jsx)(X.a,{name:"skill_"+e,color:"primary"}),label:e},e)}))})}),Object(F.jsx)(de,{header:"Pictures",xs:12,children:Object(F.jsxs)(v.a,{container:!0,children:[Object(F.jsx)(v.a,{item:!0,xs:4,children:Object(F.jsx)(y.a,{src:s,variant:"rounded",style:{width:160,height:160,cursor:"help"},onClick:j})}),Object(F.jsx)(v.a,{item:!0,xs:4,children:Object(F.jsx)(y.a,{src:c,variant:"rounded",style:{width:240,height:320,cursor:"help"},onClick:j})})]})}),Object(F.jsx)(de,{fields:[{name:"uploadSmallPicture",variant:"file",avatarWidth:80,buttonIcon:"photo_camera"},{name:"uploadBigPicture",variant:"file",avatarWidth:200,buttonIcon:"photo_camera"}],formik:t,disabled:a}),Object(F.jsx)(de,{fields:[{name:"agencyRemarks",variant:"textarea"}],header:"Agency Only Information (Hidden)",md:7,formik:t,disabled:a}),Object(F.jsx)(xe,{title:void 0===i?"Create Worker":"Save Changes",errors:t.errors,type:"submit",disabled:a||t.isSubmitting})]})}function ge(e){var t=Object(i.useState)(!0),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)([]),c=Object(p.a)(s,2),o=c[0],l=c[1],d=Object(i.useState)(""),u=Object(p.a)(d,2),j=u[0],h=u[1],b=Object(i.useState)(100),m=Object(p.a)(b,2),f=m[0],x=m[1],O=Object(i.useState)(void 0),v=Object(p.a)(O,2),y=v[0],w=v[1],C=Object(i.useState)(!1),M=Object(p.a)(C,2),T=M[0],P=M[1],A=Object(i.useState)({addressOriginalCountry:{city:""},languageSkillArabic:"Fair",languageSkillEnglish:"Fair",agencyRemarks:"",cityOfBirth:"",contractPeriod:2,demoLanguageSkillsText:"",educationalLevel:"",hidden:!0,isLocalTransfer:!1,jobExperiences:[],jobTitle:"",localTransferReason:"",maritalStatus:"",name:"",nationality:"",otherSkills:[],phone:"",processFees:0,processTemplateId:"",referenceId:"",remarks:"",weightKg:0}),q=Object(p.a)(A,2),B=q[0],I=q[1];function L(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/process-templates",{withCredentials:!0}).then((function(e){l(e.data.data),r(!1)}))}Object(i.useEffect)((function(){console.log("Pending requests",f),n?void 0!==e.id?S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year/"+e.id,{withCredentials:!0}).then((function(e){var t=e.data.data;I(t),h(t.processTemplateId),L()})):L():f<1&&(void 0!==y&&y(!1),void 0===e.navigate||!T&&T||e.navigate("/panel/my-workers/success"),x(100))}),[n,r,f,y,e,T]);var N=[{name:"processTemplateId",variant:"select",selectOptions:o.map((function(e){return{value:e._id?e._id:"NOVAL",title:e.title}})),value:j,onChange:function(e){h(e.target.value)}},{name:"processFees",readOnly:!0,value:function(){var e=o.find((function(e){return e._id===j}));return void 0===e?0:e.totalFeesBhd}()}],D=n;function _(e){var t=new FormData;return t.append("_id",e._id),t.append("folder",e.folder),t.append("file",e.file),S.a.request({method:"PUT",url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year/picture",data:t,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}})}function E(e){var t=e.result.data.message?e.result.data.message:"No Message.";ie.b.success(t),x((function(e){return e-1}))}function W(){return(W=Object(ee.a)($.a.mark((function e(t,a){var i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year",i=a?"POST":"PUT",e.abrupt("return",S.a.request({url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year",method:i,data:t,withCredentials:!0}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(F.jsxs)(g.a,{children:[n&&Object(F.jsxs)(k.a,{children:["Loading ",Object(F.jsx)("strong",{children:"Worker Details"})," and"," ",Object(F.jsx)("strong",{children:"Process Templates..."})]}),!n&&o.length<1&&Object(F.jsx)(k.a,{children:"Please first add at least 1 Process Template by using the left-side navigation."}),!n&&o.length>0&&Object(F.jsx)(te.a,{initialValues:B,validationSchema:ae.d({name:ae.e().required("Required"),experienceYears:ae.c().required("Required"),contractPeriod:ae.c().required("Required"),monthlySalary:ae.c().required("Required"),hidden:ae.a().required("Required")}),onSubmit:function(t,a){var i=a.setSubmitting;i(!0),w(i);var n=Object(R.a)(Object(R.a)({},t),{},{processTemplateId:j}),r=void 0===e.id;P(r);var s=1;void 0!==t.uploadSmallPicture&&s++,void 0!==t.uploadBigPicture&&s++,x(s),function(e,t){return W.apply(this,arguments)}(n,r).then((function(e){E({result:e,navigateOut:r,setSubmitting:i});var a=e.data.data._id;void 0!==a&&(void 0!==t.uploadSmallPicture&&_({_id:a,file:t.uploadSmallPicture,folder:"2y/sm",navigateOut:r,result:e,setSubmitting:i}).then((function(e){E({result:e,navigateOut:r,setSubmitting:i})})),void 0!==t.uploadBigPicture&&_({_id:a,file:t.uploadBigPicture,folder:"2y/lg",navigateOut:r,result:e,setSubmitting:i}).then((function(e){E({result:e,navigateOut:r,setSubmitting:i})})))})).catch((function(e){ie.b.error(e.message),i(!1)}))},children:function(t){return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(Oe,{id:e.id,formik:t,templateFields:N,disabled:D,worker:B})})}})]})}var ve=a(1908),ye=a(115),ke=a(1909),we=a(204),Se=a.n(we);function Fe(e){var t=Object(i.useState)([]),a=Object(p.a)(t,2),n=a[0],r=a[1],s=[{field:"created",headerName:"Date",sortable:!0,width:140,valueFormatter:function(e){return Se()(e.row.created,"dd mmm yy")}},{field:"avatar",headerName:"Pic",disableColumnMenu:!0,renderCell:function(e){var t=e.row.workerTwoYear,a="/2y/sm/"+t._id+"."+t.smallPictureFileExt;return Object(F.jsx)(g.a,{children:Object(F.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net"+a})})}},{field:"Tracking",sortable:!1,width:130,valueGetter:function(e){return e.row.trackingCode}},{field:"Worker Name",sortable:!0,width:200,valueGetter:function(e){return e.row.workerTwoYear.name}},{field:"status",headerName:"Status",sortable:!0,width:180},{field:"fullName",headerName:"Applicant Name",sortable:!0,width:250},{field:"mobileNumber",headerName:"Mobile",sortable:!0,width:200},{sortable:!1,disableColumnMenu:!0,field:"actions",headerName:"Actions",width:140,renderCell:function(t){return Object(F.jsx)(g.a,{textAlign:"center",children:Object(F.jsx)(ve.a,{color:"primary",variant:"outlined",children:Object(F.jsx)(D.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){console.log(t.row),e.navigate&&e.navigate("update/".concat(t.row.id))},children:Object(F.jsx)(ke.a,{fontSize:"small"})})})})}}];return Object(i.useEffect)((function(){console.log("Preparing to get Requests"),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/requests",{withCredentials:!0}).then((function(e){console.log("Got ".concat(e.data.data.length," requests")),r(e.data.data)}))}),[r]),Object(F.jsxs)(g.a,{children:[Object(F.jsx)(C,{title:"My Requests"}),Object(F.jsx)(g.a,{height:1200,children:Object(F.jsx)(ye.a,{disableSelectionOnClick:!0,rows:n.map((function(e){return Object(R.a)(Object(R.a)({},e.applicationForm),{},{trackingCode:e.trackingCode,id:e._id,workerTwoYear:e.workerTwoYear,status:e.status.title,created:e.created})})),columns:s,pageSize:15})})]})}function Ce(e){var t=Object(i.useState)([]),a=Object(p.a)(t,2),n=a[0],r=a[1],s=[{field:"referenceId",headerName:"REF",sortable:!0,width:200},{field:"avatar",headerName:"Pic",disableColumnMenu:!0,renderCell:function(e){var t="/2y/sm/"+e.row._id+"."+e.row.smallPictureFileExt;return Object(F.jsx)(g.a,{children:Object(F.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net"+t})})}},{field:"nationality",headerName:"Nationality",width:200},{field:"name",headerName:"Worker Name",sortable:!0,width:250},{field:"jobTitle",headerName:"Job Title",sortable:!0,description:"Job title of the worker",width:200},{sortable:!1,disableColumnMenu:!0,field:"actions",headerName:"Worker CV",width:140,renderCell:function(t){return Object(F.jsx)(g.a,{textAlign:"center",children:Object(F.jsx)(ve.a,{color:"primary",variant:"outlined",children:Object(F.jsx)(D.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){e.navigate&&e.navigate("edit/"+t.row._id)},children:Object(F.jsx)(ke.a,{fontSize:"small"})})})})}}];return Object(i.useEffect)((function(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year",{withCredentials:!0}).then((function(e){r(e.data.data)}))}),[r]),Object(F.jsxs)(g.a,{children:[Object(F.jsx)(C,{title:"My Workers"}),Object(F.jsx)(g.a,{height:1200,children:Object(F.jsx)(ye.a,{rows:n,columns:s,pageSize:15,checkboxSelection:!0})})]})}var Me=function(e){var t=e.fontSize?e.fontSize:13;return Object(F.jsxs)(g.a,{title:e.title,style:Object(R.a)({fontSize:t,color:b.text.secondary},e.style),children:["string"===typeof e.children&&Object(F.jsx)("div",{dangerouslySetInnerHTML:{__html:e.children}}),"string"!==typeof e.children&&Object(F.jsx)(F.Fragment,{children:e.children})]})},Te=function(e){var t=void 0===e.oneLine||e.oneLine,a=e.oneLineTitleSizeMd?e.oneLineTitleSizeMd:3,i=e.oneLineValueSizeMd?e.oneLineValueSizeMd:9,r=t?a:3,s=t?i:3;return Object(F.jsxs)(n.a.Fragment,{children:[Object(F.jsx)(v.a,{item:!0,xs:6,md:r,children:Object(F.jsx)(g.a,{pb:.5,children:Object(F.jsx)(Me,{style:Object(R.a)({fontWeight:"bold"},e.style),children:e.title})})}),Object(F.jsx)(v.a,{item:!0,xs:6,md:s,children:Object(F.jsx)(g.a,{pb:.5,children:Object(F.jsx)(Me,{style:e.style,children:e.children})})})]})};function Pe(e){var t=e.applicationForm,a=e.headerVariant;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(k.a,{variant:a,children:"Application Details"}),Object(F.jsx)(g.a,{my:2,children:Object(F.jsxs)(v.a,{container:!0,children:[Object(F.jsx)(Te,{title:"Full Name",children:t.fullName}),Object(F.jsx)(Te,{title:"Mobile",children:t.mobileNumber}),Object(F.jsx)(Te,{title:"Other Mobile",children:t.otherMobileNumber}),Object(F.jsx)(Te,{title:"Special Notes",children:t.specialNotes})]})})]})}function Re(e){var t,a=e.worker,i=e.headerVariant;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(k.a,{variant:i,children:"Requested Worker"}),Object(F.jsx)(g.a,{my:2,children:Object(F.jsxs)(v.a,{container:!0,spacing:2,children:[Object(F.jsx)(v.a,{item:!0,xs:4,children:Object(F.jsx)(y.a,{src:"".concat("https://d15f7urgawp38o.cloudfront.net","/").concat("2y/sm","/").concat(a.id,".").concat(a.smallPictureFileExt),style:{width:"100%",minHeight:160,alignSelf:"center"},variant:"rounded"})}),Object(F.jsx)(v.a,{item:!0,xs:8,children:Object(F.jsxs)(v.a,{container:!0,children:[Object(F.jsx)(Te,{title:"Agency",children:null===(t=a.agency)||void 0===t?void 0:t.title}),Object(F.jsx)(Te,{title:"Ref #",children:a.referenceId}),Object(F.jsx)(Te,{title:"Name",children:a.nationality}),Object(F.jsx)(Te,{title:"Nationality",children:a.nationality}),Object(F.jsx)(Te,{title:"Job Title",children:a.jobTitle}),Object(F.jsxs)(Te,{title:"Salary",children:["BHD ",a.monthlySalary," / Month"]}),Object(F.jsxs)(Te,{title:"Processing Fees",children:["BHD ",a.processFees]}),Object(F.jsxs)(Te,{title:"Contract Period",children:[a.contractPeriod," Years"]})]})})]})})]})}var Ae=["Pending Confirmation","In Progress","Tickets Booked","Arrived & Ready to be Collected","In Trial","Completed","Declined by Agency","Cancelled by Customer","Returned by Customer"].map((function(e){return{title:e,value:e}}));function qe(e){var t=e.formik,a=e.disabled,i=(e.request,[{name:"requestStatus",variant:"select",selectOptions:Ae},{name:"notes",variant:"textarea"},{name:"notify",label:"Notify customer of status update.",variant:"checkbox",defaultValue:!0},{name:"showHistory",label:"Record status change in the customer request's history.",variant:"checkbox",defaultValue:!0}]);return Object(F.jsxs)("form",{onSubmit:t.handleSubmit,children:[Object(F.jsxs)(v.a,{container:!0,spacing:2,children:[Object(F.jsx)(v.a,{item:!0,md:6,xs:12,children:Object(F.jsx)(de,{header:"Agency Actions",fields:i,md:12,formik:t})}),Object(F.jsx)(v.a,{item:!0,md:6,xs:12,children:Object(F.jsx)(de,{header:"History",md:12,children:"History here... (Coming soon)"})})]}),Object(F.jsx)(xe,{title:"Save",type:"submit",disabled:a||t.isSubmitting})]})}function Be(e){var t=Object(i.useState)(!0),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(null),c=Object(p.a)(s,2),o=c[0],l=c[1];return Object(i.useEffect)((function(){n&&S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/requests/"+e.id,{withCredentials:!0}).then((function(e){r(!1),l(e.data.data)}))}),[n,e.id]),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(C,{title:"Update Request",children:["Tracking # ",null===o||void 0===o?void 0:o.trackingCode]}),null!==o&&void 0!==o.workerTwoYear&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(g.a,{children:Object(F.jsxs)(v.a,{container:!0,children:[Object(F.jsx)(v.a,{item:!0,xs:6,children:Object(F.jsx)(Pe,{headerVariant:"h6",applicationForm:o.applicationForm})}),Object(F.jsx)(v.a,{item:!0,xs:6,children:Object(F.jsx)(Re,{headerVariant:"h6",worker:o.workerTwoYear})})]})}),Object(F.jsx)(g.a,{children:Object(F.jsx)(te.a,{initialValues:o,validationSchema:ae.d({}),onSubmit:function(e,t){t.setSubmitting},children:function(e){return Object(F.jsx)(qe,{formik:e,request:o,disabled:n})}})})]})]})}var Ie=a.p+"static/media/check.6b6350a4.svg";function Le(e){return Object(F.jsxs)(g.a,{textAlign:"center",children:[Object(F.jsx)(g.a,{maxWidth:120,mx:"auto",pb:3,children:Object(F.jsx)("img",{src:Ie,style:{display:"block"},alt:"success"})}),Object(F.jsx)(k.a,{variant:"h5",children:"Success!"}),Object(F.jsx)(g.a,{py:1,children:Object(F.jsx)(k.a,{variant:"h6",children:e.bigText})}),Object(F.jsx)(g.a,{children:Object(F.jsx)(k.a,{children:e.smallText})}),Object(F.jsx)(g.a,{p:2,children:Object(F.jsx)(me.a,{variant:"middle"})}),Object(F.jsx)(g.a,{children:e.children})]})}function Ne(e){var t=void 0!==e.navigate?e.navigate:function(e){};return Object(F.jsxs)(Le,{bigText:"New worker added successfully",children:[Object(F.jsx)(D.a,{variant:"contained",color:"primary",style:{marginRight:16},onClick:function(){t("../add")},children:"Add Another"}),Object(F.jsx)(D.a,{variant:"contained",color:"primary",onClick:function(){t("..")},children:"Workers List"})]})}function De(e){var t=void 0!==e.navigate?e.navigate:function(e){};return Object(F.jsx)(Le,{bigText:"Request updated successfully",children:Object(F.jsx)(D.a,{variant:"contained",color:"primary",onClick:function(){t("..")},children:"Done"})})}var _e=a(17),Ee={bahrain:{currencyCode:"BHD",currencySymbol:"BD",currencySymbolAr:"\u062f.\u0628",currencyDecimals:3,fixedProcessFees:{lmraFees:20,vatPercentage:.05,workPermitFees:30}}};function We(e){var t=e.process,a=e.region.currencyCode,i=!e.editing||e.saving,n=[{name:"title",readOnly:i}],r=[{name:"processFeesBhd",readOnly:i,suffix:a,type:"number"},{name:"governmentFeesBhd",readOnly:i,type:"number",suffix:a},{name:"insuranceFeesBhd",readOnly:i,suffix:a,type:"number"},{name:"accommodationFeesBhd",readOnly:i,suffix:a,type:"number"},{name:"otherFeesLabel",defaultValue:t.otherFeesLabel,readOnly:i,variant:"text"},{name:"otherFeesBhd",readOnly:i,suffix:a,type:"number"}],s=[{name:"vatFeesBhd",readOnly:i,suffix:a},{name:"totalFeesBhd",readOnly:!0,suffix:a}],c=[{name:"processDurationMinimumMonths",label:"Minimum",type:"number",readOnly:i,step:.25,suffix:"Months",defaultValue:t.processDurationMinimumMonths>0?t.processDurationMinimumMonths:void 0},{name:"processDurationMaximumMonths",label:"Maximum",type:"number",readOnly:i,suffix:"Months",step:.25,defaultValue:t.processDurationMaximumMonths>0?t.processDurationMaximumMonths:void 0}];return Object(F.jsxs)(g.a,{px:1,children:[Object(F.jsx)(de,{header:"Process Name",fields:n,md:6,headerVariant:"small",formik:e.formik}),Object(F.jsx)(de,{fields:r,md:4,headerVariant:"small",formik:e.formik}),Object(F.jsx)(de,{fields:s,md:4,headerVariant:"small",formik:e.formik}),Object(F.jsx)(de,{header:"Durations",fields:c,md:4,headerVariant:"small",formik:e.formik})]})}function ze(e){var t=Object(i.useState)(e.newItem),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(!1),c=Object(p.a)(s,2),o=c[0],l=c[1],d=e.process.countAssignedWorkers,u="0.7rem",j=.25;return Object(F.jsx)(g.a,{boxShadow:b.shadow.niceShadow,borderRadius:b.borderRadius.niceRadius,border:n?"2px dashed blue":"1px solid "+b.lighter,p:1,my:1,children:Object(F.jsx)(te.a,{initialValues:e.process,validationSchema:ae.d({title:ae.e().min(3,"Minimum 3 characters").required("Required"),accommodationFeesBhd:ae.c().required("Required"),governmentFeesBhd:ae.c().required("Required"),insuranceFeesBhd:ae.c().required("Required"),otherFeesBhd:ae.c().required("Required"),vatFeesBhd:ae.c().required("Required"),processFeesBhd:ae.c().min(5,"Minimum ".concat(5," BHD")).required("Required"),otherFeesLabel:ae.e().required("Required"),agencyId:ae.e().optional(),countAssignedWorkers:ae.c().optional(),created:ae.b().optional(),modified:ae.b().optional(),processDurationMinimumMonths:ae.c().min(j,"Minimum ".concat(j," Months")).required("Required"),processDurationMaximumMonths:ae.c().min(j,"Minimum ".concat(j," Months")).required("Required"),totalFeesBhd:ae.c().optional(),vatPercentage:ae.c().optional(),_id:ae.e().optional(),id:ae.e().optional()}),onSubmit:function(e,t){var a=t.setSubmitting;a(!0),l(!0);var i=void 0===e._id?"POST":"PUT";S.a.request({method:i,url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/process-templates",data:e,withCredentials:!0}).then((function(e){ie.b.success(e.data.message),r(!1),l(!1),a(!1)})).catch((function(e){ie.b.error(e.message),l(!1),a(!1)}))},children:function(t){return Object(F.jsx)("form",{onSubmit:t.handleSubmit,children:Object(F.jsxs)(v.a,{container:!0,spacing:2,alignItems:"flex-end",children:[Object(F.jsxs)(v.a,{item:!0,md:10,xs:12,children:[Object(F.jsx)(We,{process:e.process,region:e.region,editing:n,saving:o,formik:t})," "]}),Object(F.jsx)(v.a,{item:!0,md:2,xs:12,children:Object(F.jsxs)(g.a,{p:1,children:[Object(F.jsxs)(g.a,{p:1,textAlign:"center",fontSize:u,children:["Assigned Workers: ",d]}),n&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(fe,{errors:t.errors,style:{fontSize:u}}),Object(F.jsx)(g.a,{my:1,textAlign:"center",fontSize:u,color:"blue",fontStyle:"italic",children:0===Object.keys(t.errors).length&&Object(F.jsxs)(F.Fragment,{children:["Please save your changes",d>0?", they will be applied automatically to ".concat(d," workers"):""]})}),Object(F.jsx)(D.a,{fullWidth:!0,color:"primary",variant:"outlined",disabled:o,type:"submit",children:o?"Saving...":"Save"})]}),!n&&Object(F.jsx)(D.a,{fullWidth:!0,variant:"outlined",color:"primary",onClick:function(){r(!0)},children:"Edit"})]})})]})})}})})}function Ue(e){var t=Object(i.useState)([]),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(!0),c=Object(p.a)(s,2),o=c[0],l=c[1];function d(){console.log("Loading process templates..."),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/process-templates",{withCredentials:!0}).then((function(e){r(e.data.data),console.log("Process templates loaded"),l(!1)}))}return Object(i.useEffect)((function(){o&&d()}),[o]),Object(F.jsxs)(g.a,{children:[Object(F.jsx)(C,{title:"Process Templates"}),Object(F.jsx)(g.a,{children:n.map((function(e,t){return Object(F.jsx)(ze,{process:e,region:Ee.bahrain,newItem:void 0===e._id,loadProcessTemplates:d},e._id)}))}),Object(F.jsx)(g.a,{children:Object(F.jsx)(D.a,{color:"primary",variant:"contained",onClick:function(){r((function(e){return[].concat(Object(_e.a)(e),[{accommodationFeesBhd:0,insuranceFeesBhd:0,otherFeesBhd:0,processFeesBhd:0,processDurationMaximumMonths:0,processDurationMinimumMonths:0,vatFeesBhd:0,governmentFeesBhd:0,vatPercentage:0,title:"",agencyId:"",otherFeesLabel:"Others",countAssignedWorkers:0,totalFeesBhd:0,created:new Date,modified:new Date}])}))},children:"+ Add More"})}),Object(F.jsx)(xe,{title:"Exit",navigate:e.navigate,navigateUrl:"/panel/dashboard"})]})}function Ve(e){return Object(F.jsx)(G,{title:"401",subtitle:"\u274c Unauthorized",children:Object(F.jsxs)(k.a,{children:["Unauthorized or session has expired. Please make sure you have ",Object(F.jsx)(I.a,{href:"/login",children:"logged in"}),"."]})})}var He=a(1912);function Ge(e){var t=Object(i.useState)({}),a=Object(p.a)(t,2),r=a[0],s=a[1],c=Object(i.useState)(!0),o=Object(p.a)(c,2),l=o[0],d=o[1];Object(i.useEffect)((function(){l&&S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency",{withCredentials:!0}).then((function(e){s(e.data.data),d(!1)}))}),[l,d]);var u=[{name:"title",label:"Agency Name (English)",readOnly:!0},{name:"titleAr",label:"Agency Name (Arabic)",readOnly:!0},{name:"cr",readOnly:!0,defaultValue:je.a.datatype.number({min:1e4,max:99999})+"-"+je.a.datatype.number({min:0,max:9})},{name:"telephone"},{name:"mobile"},{name:"email"},{name:"openingTimes",md:12,variant:"textarea",textareaLines:4}],j=[{name:"uploadLogo",variant:"file",buttonIcon:"photo_camera"}],h=[{name:"Local Transfer Worker Terms & Conditions",variant:"textarea",textareaLines:11}],b=(g.a,be.a,pe.map((function(e){return Object(F.jsx)(K.a,{control:Object(F.jsx)(X.a,{name:"nationality_"+e,color:"primary"}),label:e},e)})),Object(F.jsx)(g.a,{my:4,children:Object(F.jsx)(me.a,{})}));function m(t){t(!1),e.navigate&&e.navigate("success")}return Object(F.jsx)(F.Fragment,{children:!l&&Object(F.jsx)(te.a,{initialValues:r,validationSchema:ae.d({}),onSubmit:function(e,t){var a=t.setSubmitting;a(!0);S.a.request({method:"PUT",url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency",data:e,withCredentials:!0}).then((function(t){ie.b.success(t.data.message),void 0!==e.uploadLogo?function(e,t){var a=new FormData;a.append("file",e),S.a.request({method:"PUT",url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency/picture",data:a,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){ie.b.success(e.data.message),m(t)}))}(e.uploadLogo,a):m(a)})).catch((function(e){ie.b.error(e.message),a(!1)}))},children:function(e){return Object(F.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(F.jsxs)(n.a.Fragment,{children:[Object(F.jsx)(C,{title:"Agency Settings"}),Object(F.jsx)(de,{header:"Agency Profile",fields:u,md:6,formik:e}),Object(F.jsx)(de,{header:"Images",xs:12,children:Object(F.jsx)(v.a,{container:!0,children:Object(F.jsx)(v.a,{item:!0,xs:4,children:Object(F.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net/agency/sm/"+r._id+"."+r.logoFileExt,variant:"rounded",style:{width:160,height:160}})})})}),Object(F.jsx)(de,{xs:12,fields:j,formik:e})]}),b,Object(F.jsxs)(F.Fragment,{children:[!1,Object(F.jsx)(C,{title:"Terms & Conditions"}),Object(F.jsx)(de,{fields:h,md:12,formik:e})]}),b,Object(F.jsxs)(n.a.Fragment,{children:[Object(F.jsx)(C,{title:"Payment Methods"}),Object(F.jsx)(g.a,{children:Object(F.jsx)(He.a,{severity:"info",children:"Currently only Cash option is available. More options will be available in near future."})}),Object(F.jsx)(xe,{errors:e.errors,type:"submit",title:"save",disabled:e.isSubmitting})]})]})}})})}function Ye(e){var t=void 0!==e.navigate?e.navigate:function(e){};return Object(F.jsx)(Le,{bigText:"Agency settings updated successfully",smallText:"If you have updated the logo, it might take up to 60 seconds to appear.",children:Object(F.jsx)(D.a,{variant:"contained",color:"primary",onClick:function(){t("/panel/dashboard")},children:"Done"})})}function Je(e){var t=Object(i.useState)(!0),a=Object(p.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(void 0),c=Object(p.a)(s,2),o=c[0],l=c[1],d=function(){return S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/auth/me",{withCredentials:!0})};Object(i.useEffect)((function(){console.log("Getting user"),n&&d().then((function(e){console.log("User received from API");var t=e.data.data;l(t),r(!1)}))}),[l,r,n]);var u=void 0!==o&&void 0!==o.agencyId&&["Agency","Agency Manager"].includes(o.role);return n?Object(F.jsx)(g.a,{p:2,textAlign:"center",children:Object(F.jsx)(k.a,{variant:"h6",children:"Loading..."})}):Object(F.jsxs)(O.c,{primary:!1,children:[Object(F.jsx)(O.b,{from:"/",to:u?"/panel":"/login",noThrow:!0}),!u&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Ve,{default:!0}),Object(F.jsx)(H,{path:"login",children:Object(F.jsx)(Q,{setUser:l,path:"/",getUser:d})})]}),u&&void 0!==o&&void 0!==o.agencyId&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Y,{default:!0}),Object(F.jsxs)(E,{path:"panel",user:o,setUser:l,children:[Object(F.jsx)(O.b,{from:"/",to:"dashboard",noThrow:!0}),Object(F.jsx)(P,{path:"dashboard",user:o}),Object(F.jsxs)(W,{path:"my-workers",children:[Object(F.jsx)(Ce,{path:"/"}),Object(F.jsx)(ge,{path:"add"}),Object(F.jsx)(ge,{path:"edit/:id"}),Object(F.jsx)(Ne,{path:"success"})]}),Object(F.jsxs)(W,{path:"my-requests",children:[Object(F.jsx)(Fe,{path:"/"}),Object(F.jsx)(Be,{path:"update/:id"}),Object(F.jsx)(De,{path:"success"})]}),Object(F.jsxs)(W,{path:"agency/settings",children:[Object(F.jsx)(Ge,{default:!0}),Object(F.jsx)(Ue,{path:"process-templates"}),Object(F.jsx)(Ye,{path:"success"})]})]})]})]})}a(1854);function Ke(e){var t=m(),a="ltr";return document.documentElement.dir=a,document.documentElement.lang="en",document.body.dir=a,document.body.lang="en",Object(F.jsxs)(c.a,{theme:x,children:[Object(F.jsx)(ie.a,{}),Object(F.jsx)("div",{className:t.root,id:"after-root",dir:a,style:{height:"100%",fontFamily:b.fontFamily.body},children:Object(F.jsx)(Je,{})})]})}a(1855);var Xe=function(){return Object(F.jsx)(Ke,{useRtl:!1})},Qe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,1916)).then((function(t){var a=t.getCLS,i=t.getFID,n=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),i(e),n(e),r(e),s(e)}))};s.a.render(Object(F.jsx)(n.a.StrictMode,{children:Object(F.jsx)(Xe,{})}),document.getElementById("root")),Qe()},236:function(e,t,a){}},[[1856,1,2]]]);
//# sourceMappingURL=main.153f7073.chunk.js.map