(this["webpackJsonpestreeh-web-agencies-frontend"]=this["webpackJsonpestreeh-web-agencies-frontend"]||[]).push([[0],{1855:function(e,t,i){},1856:function(e,t,i){"use strict";i.r(t);var a=i(0),n=i.n(a),r=i(16),s=i.n(r),c=(i(236),i(1910)),o=(i(237),i(148)),l=i(193),d=i(75),u=i.n(d),j="#B3D9E3",h="#E6F1F4",b={primary:"#5890A7",light:j,lighter:"#D9E5EA",lightest:h,lightBg:"#f8f8f8",warning:"#ffd294",dark:"#172C42",slotColors:{free:"#a0ffae",booked:"#ff929c",off:"#dfdfdf",hover:j,selected:h,shadowColor:function(e){return new u.a(e).darken(.5).alpha(.5).toString()},shadow:function(e,t,i){var a=t||1;return a+"px "+a+"px "+(i||2)+"px "+new u.a(e).darken(.5).alpha(.5).toString()}},slotColorsDot:{free:"#50af56",booked:"#ea1542",off:"#dfdfdf"},text:{primary:"#000000",secondary:"#777777",warning:u()("#ffd294").darken(.45).string()},fontSize:{small:13},fontFamily:{heading:"",body:'"Roboto", "Segoe UI", "Helvetica", "Arial", open_sansregular,Helvetica Neue,Helvetica,-apple-system, BlinkMacSystemFont, "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif'},shadow:{niceShadow:"0 0 25px #00000011"},borderRadius:{niceRadius:10},transition:"all 0.1s"},m=Object(o.a)((function(e){return Object(l.a)({root:{flexGrow:1,"& a":{color:b.primary},"& .material-icons":{verticalAlign:"text-bottom"},"& .transitionDefault":{transition:b.transition},"& .MuiTextField-root":{marginTop:e.spacing(.5),marginBottom:e.spacing(.5),width:"100%"},"& .MuiAvatar-img":{objectFit:"contain"},"& .notched-outline-no-border":{borderTop:0,borderRight:0,borderBottom:0}},objectFitContain:{"& .MuiAvatar-img":{objectFit:"contain"}},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.primary},transitionDefault:{transition:b.transition},wizardCardLink:{display:"block",color:"#000",borderRadius:10,boxShadow:"0 0 22px #00000022",background:"white",textDecoration:"none",transition:b.transition,"&:hover":{background:b.lightest,boxShadow:"0 0 2px "+b.primary}},hoverBox:{transition:b.transition,userSelect:"none","&:hover":{backgroundColor:b.lightBg}}})})),f=i(70),x=Object(f.a)({palette:{primary:{main:b.primary},secondary:{main:b.warning},contrastThreshold:3,tonalOffset:.2},typography:{fontFamily:b.fontFamily.body}}),p=i(5),O=i(35),g=i(1911),v=i(1897),y=i(1913),k=i(131),w=i(17),S=i.n(w),C=i(1);function F(e){return Object(C.jsxs)(g.a,{mb:2,children:[Object(C.jsx)(k.a,{variant:"h4",children:e.title}),Object(C.jsx)(k.a,{variant:"h5",style:{color:b.text.secondary},children:e.children})]})}var M=i(1898);function T(e){return Object(C.jsx)(v.a,{item:!0,md:3,xs:12,children:Object(C.jsxs)(g.a,{bgcolor:b.lighter,p:3,borderRadius:b.borderRadius.niceRadius,boxShadow:b.shadow.niceShadow,textAlign:"center",children:[Object(C.jsx)(g.a,{pb:2,children:Object(C.jsx)(k.a,{style:{textTransform:"uppercase"},children:e.title})}),Object(C.jsxs)(g.a,{pb:2,fontSize:"3.5rem",children:[void 0===e.value&&Object(C.jsx)(M.a,{variant:"text",width:120,animation:"wave",style:{marginLeft:"auto",marginRight:"auto"}}),void 0!==e.value&&Object(C.jsx)(g.a,{children:e.value})]})]})})}function P(e){var t=Object(a.useState)(void 0),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)(null),c=Object(p.a)(s,2),o=c[0],l=c[1];return Object(a.useEffect)((function(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/dashboard",{withCredentials:!0}).then((function(e){r(e.data.data),console.log("Got dashboard summary",e.data.data)})),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency",{withCredentials:!0}).then((function(e){l(e.data.data),console.log("Got agency")}))}),[r]),Object(C.jsx)(g.a,{children:Object(C.jsxs)(v.a,{container:!0,direction:"row-reverse",spacing:2,children:[Object(C.jsx)(v.a,{item:!0,md:3,xs:12,children:Object(C.jsxs)(g.a,{textAlign:"center",children:[Object(C.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net/agency/sm/"+(null===o||void 0===o?void 0:o._id)+"."+(null===o||void 0===o?void 0:o.logoFileExt),variant:"rounded",style:{width:260,height:220,marginLeft:"auto",marginRight:"auto"}}),Object(C.jsx)(k.a,{children:null===o||void 0===o?void 0:o.title}),Object(C.jsx)(k.a,{children:null===o||void 0===o?void 0:o.titleAr}),Object(C.jsxs)(k.a,{children:["CR: ",null===o||void 0===o?void 0:o.cr]})]})}),Object(C.jsxs)(v.a,{item:!0,md:9,xs:12,children:[Object(C.jsx)(F,{title:"Welcome, ".concat(e.user.fullName)}),Object(C.jsx)(k.a,{children:"Welcome to the Estreeh agency portal."}),Object(C.jsx)(k.a,{children:"Please use the left menu to navigate."}),Object(C.jsx)(g.a,{p:3,children:Object(C.jsxs)(v.a,{container:!0,spacing:2,alignItems:"center",children:[Object(C.jsx)(T,{title:"New Requests",value:null===n||void 0===n?void 0:n.newRequests}),Object(C.jsx)(T,{title:"Pending Requests",value:null===n||void 0===n?void 0:n.pendingRequests}),Object(C.jsx)(T,{title:"My Workers",value:null===n||void 0===n?void 0:n.myWorkers}),Object(C.jsx)(T,{title:"Customer Reviews",value:null===n||void 0===n?void 0:n.customerReviews})]})})]})]})})}var R=i(23),A=i.p+"static/media/logo.d1016dba.svg";function q(e){return Object(C.jsx)("img",{src:A,style:Object(R.a)({display:"block",maxWidth:"100%",margin:"0",maxHeight:40},e.styles),alt:"Estreeh Logo"})}var B=i(1899),I=i(1900);function L(e){var t,i=e.navItem,a={display:"block",color:"white",padding:"2px 8px",textDecoration:"none"},n=Object(C.jsxs)(g.a,{children:[i.icon&&Object(C.jsx)(B.a,{fontSize:"small",style:{marginRight:6},children:i.icon}),i.title]});return Object(C.jsxs)(g.a,{ml:e.mx,my:e.my,children:[i.to&&Object(C.jsx)(O.a,{style:Object(R.a)({},a),to:i.to,children:n}),!i.to&&Object(C.jsx)(I.a,{href:"#",style:Object(R.a)({},a),children:n}),void 0!==e.navItem.children&&Object(C.jsx)(g.a,{fontSize:"90%",children:null===(t=e.navItem.children)||void 0===t?void 0:t.map((function(e){return Object(C.jsx)(L,{my:.5,mx:5,navItem:e},e.title+"_"+e.to)}))})]})}function N(e){return Object(C.jsx)(g.a,{position:"fixed",width:"16.6666667%",height:"100%",children:Object(C.jsxs)(g.a,{bgcolor:b.primary,color:"white",height:"100%",children:[Object(C.jsx)(g.a,{p:2,bgcolor:b.lighter,textAlign:"left",children:Object(C.jsx)(O.a,{to:"/panel",style:{display:"inline-block"},children:Object(C.jsx)(q,{})})}),Object(C.jsx)(g.a,{px:0,py:4,children:[{key:"dash1",title:"Dashboard",to:"/panel/dashboard",icon:"arrow_forward_ios"},{key:"myrequests",title:"My Requests",to:"/panel/my-requests",icon:"arrow_forward_ios"},{key:"myworkers",title:"My Workers",to:"/panel/my-workers",icon:"arrow_forward_ios",children:[{key:"mw-manageworkers",title:"Manage Workers",to:"/panel/my-workers"},{key:"mw-addnewworker",title:"Add New Worker",to:"/panel/my-workers/add"}]},{key:"agencysettings",title:"Agency Settings",icon:"arrow_forward_ios",children:[{key:"as-settings",title:"General Settings",to:"/panel/agency/settings"},{key:"as-processes",title:"Process Templates",to:"/panel/agency/settings/process-templates"},{key:"as-qr",title:"QR Code"}]}].map((function(e){return Object(C.jsx)(L,{my:2,mx:1,navItem:e},e.title+"_"+e.to)}))})]})})}var _=i(60);function D(e){var t=u()(b.lightBg).alpha(.8).string(),i={lineHeight:"40px"};return Object(C.jsx)(g.a,{position:"fixed",top:0,right:0,left:"16.66667%",zIndex:1e3,children:Object(C.jsx)(g.a,{p:2,bgcolor:t,children:Object(C.jsx)(v.a,{container:!0,spacing:3,direction:"row-reverse",children:Object(C.jsx)(v.a,{item:!0,children:Object(C.jsx)(g.a,{children:Object(C.jsxs)(v.a,{container:!0,spacing:1,children:[Object(C.jsxs)(v.a,{item:!0,style:i,children:["Welcome ",e.user.fullName]}),Object(C.jsx)(v.a,{item:!0,style:i,children:Object(C.jsx)(_.a,{color:"primary",onClick:function(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/auth/logout",{withCredentials:!0}).then((function(t){e.setUser(void 0),Object(O.d)("/login")}))},children:"Logout"})}),Object(C.jsx)(v.a,{item:!0,children:Object(C.jsx)(y.a,{})})]})})})})})})}function E(e){return Object(C.jsx)(g.a,{height:"100%",children:Object(C.jsx)(v.a,{container:!0,direction:"column",style:{height:"100%"},children:Object(C.jsx)(v.a,{item:!0,xs:12,children:Object(C.jsxs)(v.a,{container:!0,alignItems:"stretch",style:{height:"100%"},children:[Object(C.jsx)(v.a,{item:!0,md:2,xs:2,children:Object(C.jsx)(N,{})}),Object(C.jsxs)(v.a,{item:!0,md:10,xs:10,children:[Object(C.jsx)(D,{user:e.user,setUser:e.setUser}),Object(C.jsx)(g.a,{px:2,pb:2,pt:12,children:e.children})]})]})})})})}function W(e){return Object(C.jsx)(C.Fragment,{children:e.children})}var z=i(33),U=i(1902),H=i(1901);function V(e){var t=Object(z.a)(),i=Object(H.a)(t.breakpoints.up("md")),a=i?"right":"bottom";return Object(C.jsxs)(v.a,{container:!0,children:[Object(C.jsx)(v.a,{item:!0,md:5,xs:12,children:Object(C.jsx)(g.a,{px:4,bgcolor:b.lightest,style:{backgroundImage:"linear-gradient(to ".concat(a,", ").concat(b.lightest," 75%, ").concat("#fff",")")},height:i?"100vh":void 0,children:Object(C.jsxs)(g.a,{py:i?6:3,style:{textShadow:"0 0 8px #ffffff"},children:[Object(C.jsx)(q,{styles:{maxHeight:i?120:50,marginBottom:24}}),Object(C.jsx)(k.a,{variant:i?"h4":"h5",children:"Estreeh Management Portal"}),Object(C.jsx)(k.a,{children:"Please login to access your management portal."})]})})}),Object(C.jsx)(v.a,{item:!0,md:7,xs:12,children:Object(C.jsxs)(U.a,{children:[i&&Object(C.jsx)(g.a,{py:4,children:Object(C.jsx)(q,{styles:{maxHeight:50,margin:"0 auto"}})}),Object(C.jsx)(g.a,{children:e.children})]})})]})}function Y(e){return Object(C.jsx)(U.a,{children:Object(C.jsxs)(g.a,{m:5,p:3,boxShadow:b.shadow.niceShadow,children:[Object(C.jsx)(k.a,{variant:"h1",children:e.title}),Object(C.jsx)(k.a,{variant:"h5",children:e.subtitle}),Object(C.jsxs)(g.a,{py:2,children:[Object(C.jsx)(g.a,{mb:1,children:e.children}),Object(C.jsx)(g.a,{children:Object(C.jsx)(k.a,{children:Object(C.jsx)(I.a,{href:"/",children:"Back to homepage."})})})]})]})})}function G(e){return Object(C.jsx)(Y,{title:"404",subtitle:"\ud83e\udd28 Page not found",children:Object(C.jsx)(k.a,{children:"Sorry but the page you're looking for cannot be found. Please double check the link you have entered."})})}var J=i(136),K=i(1860),X=i(214);function Q(e){var t=Object(a.useState)(!1),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)(""),c=Object(p.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)(""),u=Object(p.a)(d,2),j=u[0],h=u[1],m=["Agency","Agency Manager"],f=function(e){r(!1),void 0!==e&&console.log("Login error:",e)};return Object(C.jsx)(g.a,{children:Object(C.jsx)(g.a,{p:3,maxWidth:440,marginLeft:"auto",marginRight:"auto",my:5,boxShadow:b.shadow.niceShadow,borderRadius:b.borderRadius.niceRadius,children:Object(C.jsxs)("form",{children:[Object(C.jsx)(J.a,{id:"username",label:"Email",variant:"outlined",value:j,onChange:function(e){return h(e.target.value)}}),Object(C.jsx)(J.a,{id:"username",label:"Password",variant:"outlined",type:"password",value:o,onChange:function(e){return l(e.target.value)}}),Object(C.jsx)(g.a,{py:0,children:Object(C.jsxs)(v.a,{container:!0,spacing:1,children:[Object(C.jsx)(v.a,{item:!0,xs:6,children:Object(C.jsx)(K.a,{control:Object(C.jsx)(X.a,{name:"checkedB",color:"primary",size:"small"}),label:"Keep me Logged In"})}),Object(C.jsx)(v.a,{item:!0,xs:6,children:Object(C.jsx)(g.a,{textAlign:"right",children:Object(C.jsx)(O.a,{to:"reset-password",children:Object(C.jsx)(g.a,{lineHeight:"38px",children:"Forgot password?"})})})})]})}),Object(C.jsx)(g.a,{py:3,textAlign:"center",children:Object(C.jsx)(_.a,{disabled:n,variant:"contained",color:"primary",onClick:function(){r(!0);var t={email:j,password:o};S.a.post("https://estreeh-dev-apis.herokuapp.com/api/v1/auth/login",t,{withCredentials:!0}).then((function(t){var i=t.data.data;void 0!==i&&void 0!==i.agencyId&&m.includes(i.role)?e.getUser().then((function(t){e.setUser(t.data.data),Object(O.d)("/")})).finally((function(){f()})):f("User is not authorized to use this platform.")})).catch((function(e){f(e)}))},children:"Login"})})]})})})}var Z=i(129),$=i.n(Z),ee=i(199),te=i(56),ie=i(15),ae=i(30),ne=i(1905),re=i(61),se=i(1861);function ce(e){var t=e.field.name.toString(),i=Object(a.useMemo)((function(){return void 0!==e.field.label?e.field.label:oe(t)}),[e.field.label,t]),n="field_"+t,r=void 0!==e.field.type?e.field.type:"text",s=void 0!==e.field.variant?e.field.variant:"text",c=void 0!==e.defaultXs?e.defaultXs:12,o=void 0!==e.defaultMd?e.defaultMd:4,l=void 0!==e.field.xs?e.field.xs:c,d=void 0!==e.field.md?e.field.md:o,u=void 0!==e.size?e.size:"medium",j=Object(a.useMemo)((function(){return{shrink:!0}}),[]),h=(e.field.readOnly,"outlined"),b="textarea"===e.field.variant?3:void 0,m=void 0!==e.field.textareaLines?e.field.textareaLines:b,f=void 0!==e.field.numberMinimum?e.field.numberMinimum:0,x=Object(a.useMemo)((function(){return e.field.onChange?e.field.onChange:function(){}}),[e.field.onChange]),p=Object(a.useMemo)((function(){return void 0!==e.field.prefix?Object(C.jsx)(ne.a,{position:"start",children:e.field.prefix}):void 0}),[e.field.prefix]),O=Object(a.useMemo)((function(){return void 0!==e.field.suffix?Object(C.jsx)(ne.a,{position:"end",children:e.field.suffix}):void 0}),[e.field.suffix]),g=Object(a.useMemo)((function(){return void 0!==e.formik?e.formik.getFieldProps(t):{onChange:x,name:t,value:e.field.value,checked:e.field.value,onBlur:function(){}}}),[x,t,e.field.value,e.formik]),y=void 0!==e.formik&&e.formik.touched[t]&&void 0!==e.formik.errors[t],k=void 0!==e.formik&&e.formik.touched[t]&&e.formik.errors[t],w=Object(a.useMemo)((function(){return"select"===e.field.variant?e.field.selectOptions.length>0?e.field.selectOptions:[]:void 0}),[e.field]),S=Object(a.useMemo)((function(){return void 0!==w&&w.map((function(e){var t=void 0!==e.title?e.title:oe(e.value);return Object(C.jsx)(re.a,{value:e.value,style:{color:e.color},children:t},"opt_"+e.value)}))}),[w]),F=Object(a.useMemo)((function(){return"switch"===s?Object(C.jsx)(se.a,Object(R.a)({color:"primary"},g)):Object(C.jsx)(X.a,Object(R.a)({color:"primary"},g))}),[g,s]),M=Object(a.useMemo)((function(){return Object(C.jsxs)(C.Fragment,{children:[("file"!==s&&"switch"!==s&&"checkbox"!==s&&"select"!==e.field.variant||"select"===e.field.variant&&void 0!==w&&(null===w||void 0===w?void 0:w.length)>0)&&Object(C.jsx)(J.a,Object(R.a)(Object(R.a)({id:n,color:"primary",variant:h,type:e.field.type,label:i+(void 0===e.formik?" [UNBOUND]":""),size:u,select:"select"===s,multiline:"textarea"===s,rows:m,InputLabelProps:"date"===r?j:void 0,disabled:e.field.disabled||e.disabled,inputProps:{min:f,step:e.field.step},InputProps:{startAdornment:p,endAdornment:O,readOnly:e.field.readOnly,classes:e.field.readOnly?{notchedOutline:"notched-outline-no-border"}:void 0},error:y,helperText:k},g),{},{children:S})),("switch"===s||"checkbox"===s)&&Object(C.jsx)(K.a,Object(R.a)({control:F,label:i},g)),"file"===s&&Object(C.jsxs)(_.a,{variant:"contained",component:"label",children:[void 0!==e.field.buttonIcon&&Object(C.jsx)(B.a,{style:{marginRight:8},children:e.field.buttonIcon}),i,Object(C.jsx)("input",{type:"file",id:n,name:t,hidden:!0,onChange:function(i){if(null!==i.currentTarget.files){var a=i.currentTarget.files[0];void 0!==e.formik&&(console.log(a),e.formik.setFieldValue(t,a))}}})]}),"file"===s&&!1]})}),[F,y,g,h,k,n,i,j,S,t,f,p,e.disabled,e.field.avatarWidth,e.field.buttonIcon,e.field.disabled,e.field.readOnly,e.field.step,e.field.type,e.field.variant,e.formik,m,w,u,O,r,s]);return Object(C.jsx)(v.a,{item:!0,xs:l,md:d,children:M})}function oe(e){if(void 0!==e){var t=("string"===typeof e?e:e.toString()).replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}throw new Error("Text is undefined")}function le(e){var t=void 0!==e.variant?e.variant:"normal",i="small"===t,a="normal"===t;return Object(C.jsx)(C.Fragment,{children:e.header&&Object(C.jsx)(g.a,{py:i?1:2,children:Object(C.jsx)(k.a,{variant:a?"h6":void 0,children:e.header})})})}function de(e){return Object(C.jsxs)(g.a,{children:[Object(C.jsx)(le,{header:e.header,variant:e.headerVariant}),Object(C.jsx)(g.a,{mb:2,children:Object(C.jsx)(k.a,{color:"primary",children:e.helpText})}),Object(C.jsxs)(v.a,{container:!0,spacing:2,alignItems:"center",children:[void 0!==e.fields&&e.fields.map((function(t){return Object(C.jsx)(ce,{formik:e.formik,field:t,defaultMd:e.md,defaultXs:e.xs,size:"small",disabled:e.disabled},t.name.toString())})),void 0!==e.children&&Object(C.jsx)(v.a,{item:!0,xs:e.xs,md:e.md,children:e.children})]})]})}var ue=i(90),je=i.n(ue),he=["House Maid","Nanny","Driver","Chef","Farmer"],be=([{fullTitle:"Lease hourly",title:"By Hour",isRentalHourly:!0,feesBhdUnit:"Hour",feesBhd:2},{fullTitle:"Lease monthly",title:"Full Month",isRentalMonthly:!0,feesBhd:10*je.a.random.number({min:15,max:35}),feesBhdUnit:"Month"}].map((function(e){return e.fullTitle})),i(1907)),me=i(1906);function fe(e){var t=[];if(Object.keys(e.errors).length>0)for(var i in e.errors)t.push({key:i,value:e.errors[i]});return Object(C.jsx)("ul",{style:{margin:0,padding:0},children:t.map((function(t){return Object(C.jsxs)("li",{style:Object(R.a)({listStylePosition:"inside",color:"red",fontSize:11},e.style),children:[Object(C.jsx)("strong",{children:t.key})," ",t.value]})}))})}function xe(e){var t=void 0!==e.navigateUrl?e.navigateUrl:"success";return Object(C.jsxs)(g.a,{children:[Object(C.jsx)(g.a,{my:3,children:Object(C.jsx)(me.a,{})}),Object(C.jsxs)(g.a,{my:3,textAlign:"right",maxWidth:160,marginLeft:"auto",children:[void 0!==e.errors&&Object(C.jsx)(g.a,{my:3,children:Object(C.jsx)(fe,{errors:e.errors})}),Object(C.jsx)(_.a,{fullWidth:!0,variant:"contained",color:"primary",type:e.type,onClick:function(){e.navigate&&e.navigate(t)},disabled:e.disabled,children:e.title})]})]})}var pe=["Philippines","Indonesia","India","Sri Lanka","Ethiopia","Kenya","Ghana"];function Oe(e){var t=e.formik,i=e.disabled,a=e.id,n=e.worker,r=e.templateFields,s="https://d15f7urgawp38o.cloudfront.net/2y/sm/"+n._id+"."+n.smallPictureFileExt,c="https://d15f7urgawp38o.cloudfront.net/2y/lg/"+n._id+"."+n.bigPictureFileExt,o=[{name:"name"},{name:"referenceId"},{name:"jobTitle",variant:"select",selectOptions:he.map((function(e){return{value:e}}))},{name:"monthlySalary"},{name:"contractPeriod"},{name:"phone"},{name:"isLocalTransfer",variant:"checkbox"}],l=[{name:"nationality",variant:"select",selectOptions:pe.map((function(e){return{value:e}}))},{name:"experienceYears",type:"number"},{name:"educationalLevel"},{name:"dateOfBirth",type:"date"},{name:"maritalStatus",variant:"select",selectOptions:[{value:"Single"},{value:"Married"}]},{name:"age",type:"number"},{name:"weightKg"},{name:"complexion"},{name:"religion"},{name:"numberOfChildren",type:"number"},{name:"heightCm"},{name:"remarks",variant:"textarea",md:9}],d=[{value:"Poor"},{value:"Fair"},{value:"Fluent"}],u=[{name:"languageSkillEnglish",variant:"select",selectOptions:d},{name:"languageSkillArabic",variant:"select",selectOptions:d}];function j(){alert("To change picture please use the Upload Picture buttons near the end of this page.")}return Object(C.jsxs)("form",{onSubmit:t.handleSubmit,children:[Object(C.jsxs)(v.a,{container:!0,spacing:2,children:[Object(C.jsx)(v.a,{item:!0,children:Object(C.jsx)(y.a,{src:s,variant:"rounded",style:{width:90,height:90,cursor:"help"},onClick:j})}),Object(C.jsx)(v.a,{item:!0,xs:9,children:Object(C.jsx)(F,{title:void 0===a?"Add a New Worker":"Edit Worker: "+n.name})})]}),Object(C.jsx)(de,{fields:o,header:"Main Information",formik:t,disabled:i}),Object(C.jsx)(de,{fields:[{name:"localTransferReason",variant:"textarea"}],md:7,formik:t,disabled:i}),Object(C.jsx)(de,{fields:r,header:"Process Template",disabled:i}),Object(C.jsx)(de,{fields:l,header:"Personal Details",formik:t,disabled:i}),Object(C.jsx)(de,{fields:u,header:"Language Skills",formik:t,disabled:i}),Object(C.jsx)(de,{header:"Skills",xs:12,formik:t,disabled:i,children:Object(C.jsx)(be.a,{row:!0,children:["Baby Sitting","Cooking","Nursing","Elder Caring","Washing","Ironing"].map((function(e){return Object(C.jsx)(K.a,{control:Object(C.jsx)(X.a,{name:"skill_"+e,color:"primary"}),label:e},e)}))})}),Object(C.jsx)(de,{header:"Pictures",xs:12,children:Object(C.jsxs)(v.a,{container:!0,children:[Object(C.jsx)(v.a,{item:!0,xs:4,children:Object(C.jsx)(y.a,{src:s,variant:"rounded",style:{width:160,height:160,cursor:"help"},onClick:j})}),Object(C.jsx)(v.a,{item:!0,xs:4,children:Object(C.jsx)(y.a,{src:c,variant:"rounded",style:{width:240,height:320,cursor:"help"},onClick:j})})]})}),Object(C.jsx)(de,{fields:[{name:"uploadSmallPicture",variant:"file",avatarWidth:80,buttonIcon:"photo_camera"},{name:"uploadBigPicture",variant:"file",avatarWidth:200,buttonIcon:"photo_camera"}],formik:t,disabled:i}),Object(C.jsx)(de,{fields:[{name:"agencyRemarks",variant:"textarea"}],header:"Agency Only Information (Hidden)",md:7,formik:t,disabled:i}),Object(C.jsx)(xe,{title:void 0===a?"Create Worker":"Save Changes",errors:t.errors,type:"submit",disabled:i||t.isSubmitting})]})}function ge(e){var t=Object(a.useState)(!0),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)([]),c=Object(p.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)(""),u=Object(p.a)(d,2),j=u[0],h=u[1],b=Object(a.useState)(100),m=Object(p.a)(b,2),f=m[0],x=m[1],O=Object(a.useState)(void 0),v=Object(p.a)(O,2),y=v[0],w=v[1],F=Object(a.useState)(!1),M=Object(p.a)(F,2),T=M[0],P=M[1],A=Object(a.useState)({addressOriginalCountry:{city:""},languageSkillArabic:"Fair",languageSkillEnglish:"Fair",agencyRemarks:"",cityOfBirth:"",contractPeriod:2,demoLanguageSkillsText:"",educationalLevel:"",hidden:!0,isLocalTransfer:!1,jobExperiences:[],jobTitle:"",localTransferReason:"",maritalStatus:"",name:"",nationality:"",otherSkills:[],phone:"",processFees:0,processTemplateId:"",referenceId:"",remarks:"",weightKg:0}),q=Object(p.a)(A,2),B=q[0],I=q[1];function L(){var e=o.find((function(e){return e._id===j}));return void 0===e?0:e.totalFeesBhd}function N(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/process-templates",{withCredentials:!0}).then((function(e){l(e.data.data),r(!1)}))}Object(a.useEffect)((function(){n?void 0!==e.id?S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year/"+e.id,{withCredentials:!0}).then((function(e){var t=e.data.data;I(t),h(t.processTemplateId),N()})):N():f<1?(void 0!==y&&y(!1),void 0===e.navigate||!T&&T||e.navigate("/panel/my-workers/success"),x(100)):console.log("Pending requests",f)}),[n,r,f,y,e,T]);var _=[{name:"processTemplateId",variant:"select",selectOptions:o.map((function(e){return{value:e._id?e._id:"NOVAL",title:e.title}})),value:j,onChange:function(e){h(e.target.value)}},{name:"processFees",readOnly:!0,value:L()}],D=n;function E(e){var t=new FormData;return t.append("_id",e._id),t.append("folder",e.folder),t.append("file",e.file),S.a.request({method:"PUT",url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year/picture",data:t,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}})}function W(e){var t=e.result.data.message?e.result.data.message:"No Message.";ae.b.success(t),x((function(e){return e-1}))}function z(){return(z=Object(ee.a)($.a.mark((function e(t,i){var a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year",a=i?"POST":"PUT",e.abrupt("return",S.a.request({url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year",method:a,data:t,withCredentials:!0}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(C.jsxs)(g.a,{children:[n&&Object(C.jsxs)(k.a,{children:["Loading ",Object(C.jsx)("strong",{children:"Worker Details"})," and"," ",Object(C.jsx)("strong",{children:"Process Templates..."})]}),!n&&o.length<1&&Object(C.jsx)(k.a,{children:"Please first add at least 1 Process Template by using the left-side navigation."}),!n&&o.length>0&&Object(C.jsx)(te.a,{initialValues:B,validationSchema:ie.d({name:ie.e().required("Required"),experienceYears:ie.c().required("Required"),contractPeriod:ie.c().required("Required"),monthlySalary:ie.c().required("Required"),hidden:ie.a().required("Required")}),onSubmit:function(t,i){var a=i.setSubmitting;a(!0),w(a);var n=Object(R.a)(Object(R.a)({},t),{},{processTemplateId:j,processFees:L()}),r=void 0===e.id;P(r);var s=1;void 0!==t.uploadSmallPicture&&s++,void 0!==t.uploadBigPicture&&s++,x(s),function(e,t){return z.apply(this,arguments)}(n,r).then((function(e){W({result:e,navigateOut:r,setSubmitting:a});var i=e.data.data._id;void 0!==i&&(void 0!==t.uploadSmallPicture&&E({_id:i,file:t.uploadSmallPicture,folder:"2y/sm",navigateOut:r,result:e,setSubmitting:a}).then((function(e){W({result:e,navigateOut:r,setSubmitting:a})})),void 0!==t.uploadBigPicture&&E({_id:i,file:t.uploadBigPicture,folder:"2y/lg",navigateOut:r,result:e,setSubmitting:a}).then((function(e){W({result:e,navigateOut:r,setSubmitting:a})})))})).catch((function(e){ae.b.error(e.message),a(!1)}))},children:function(t){return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(Oe,{id:e.id,formik:t,templateFields:_,disabled:D,worker:B})})}})]})}var ve=i(1908),ye=i(116),ke=i(1909),we=i(115),Se=i.n(we);function Ce(e){var t=Object(a.useState)([]),i=Object(p.a)(t,2),n=i[0],r=i[1],s=[{field:"created",headerName:"Date",sortable:!0,width:140,valueFormatter:function(e){return Se()(e.row.created,"dd mmm yy")}},{field:"avatar",headerName:"Pic",disableColumnMenu:!0,renderCell:function(e){var t=e.row.workerTwoYear,i="/2y/sm/"+t._id+"."+t.smallPictureFileExt;return Object(C.jsx)(g.a,{children:Object(C.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net"+i})})}},{field:"Tracking",sortable:!1,width:130,valueGetter:function(e){return e.row.trackingCode}},{field:"Worker Name",sortable:!0,width:200,valueGetter:function(e){return e.row.workerTwoYear.name}},{field:"statusCode",headerName:"Status",sortable:!0,width:180,valueGetter:function(t){var i;return null===(i=e.config.statusCodesTwoYear.find((function(e){return e.code===t.row.statusCode})))||void 0===i?void 0:i.title}},{field:"fullName",headerName:"Applicant Name",sortable:!0,width:250},{field:"mobileNumber",headerName:"Mobile",sortable:!0,width:200},{sortable:!1,disableColumnMenu:!0,field:"actions",headerName:"Actions",width:140,renderCell:function(t){return Object(C.jsx)(g.a,{textAlign:"center",children:Object(C.jsx)(ve.a,{color:"primary",variant:"outlined",children:Object(C.jsx)(_.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){console.log(t.row),e.navigate&&e.navigate("update/".concat(t.row.id))},children:Object(C.jsx)(ke.a,{fontSize:"small"})})})})}}];return Object(a.useEffect)((function(){console.log("Preparing to get Requests"),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/requests",{withCredentials:!0}).then((function(e){console.log("Got ".concat(e.data.data.length," requests")),r(e.data.data)}))}),[r]),Object(C.jsxs)(g.a,{children:[Object(C.jsx)(F,{title:"My Requests"}),Object(C.jsx)(g.a,{height:1200,children:Object(C.jsx)(ye.a,{disableSelectionOnClick:!0,rows:n.map((function(e){return Object(R.a)(Object(R.a)({},e.applicationForm),{},{trackingCode:e.trackingCode,id:e._id,workerTwoYear:e.workerTwoYear,statusCode:e.statusCode,created:e.created})})),columns:s,pageSize:15})})]})}function Fe(e){var t=Object(a.useState)([]),i=Object(p.a)(t,2),n=i[0],r=i[1],s=[{field:"referenceId",headerName:"REF",sortable:!0,width:200},{field:"avatar",headerName:"Pic",disableColumnMenu:!0,renderCell:function(e){var t="/2y/sm/"+e.row._id+"."+e.row.smallPictureFileExt;return Object(C.jsx)(g.a,{children:Object(C.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net"+t})})}},{field:"nationality",headerName:"Nationality",width:200},{field:"name",headerName:"Worker Name",sortable:!0,width:250},{field:"jobTitle",headerName:"Job Title",sortable:!0,description:"Job title of the worker",width:200},{sortable:!1,disableColumnMenu:!0,field:"actions",headerName:"Worker CV",width:140,renderCell:function(t){return Object(C.jsx)(g.a,{textAlign:"center",children:Object(C.jsx)(ve.a,{color:"primary",variant:"outlined",children:Object(C.jsx)(_.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){e.navigate&&e.navigate("edit/"+t.row._id)},children:Object(C.jsx)(ke.a,{fontSize:"small"})})})})}}];return Object(a.useEffect)((function(){S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/workers-two-year",{withCredentials:!0}).then((function(e){r(e.data.data)}))}),[r]),Object(C.jsxs)(g.a,{children:[Object(C.jsx)(F,{title:"My Workers"}),Object(C.jsx)(g.a,{height:1200,children:Object(C.jsx)(ye.a,{rows:n,columns:s,pageSize:15,checkboxSelection:!0})})]})}var Me=function(e){var t=e.fontSize?e.fontSize:13;return Object(C.jsxs)(g.a,{title:e.title,style:Object(R.a)({fontSize:t,color:b.text.secondary},e.style),children:["string"===typeof e.children&&Object(C.jsx)("div",{dangerouslySetInnerHTML:{__html:e.children}}),"string"!==typeof e.children&&Object(C.jsx)(C.Fragment,{children:e.children})]})},Te=function(e){var t=void 0===e.oneLine||e.oneLine,i=e.oneLineTitleSizeMd?e.oneLineTitleSizeMd:3,a=e.oneLineValueSizeMd?e.oneLineValueSizeMd:9,r=t?i:3,s=t?a:3;return Object(C.jsxs)(n.a.Fragment,{children:[Object(C.jsx)(v.a,{item:!0,xs:6,md:r,children:Object(C.jsx)(g.a,{pb:.5,children:Object(C.jsx)(Me,{style:Object(R.a)({fontWeight:"bold"},e.style),children:e.title})})}),Object(C.jsx)(v.a,{item:!0,xs:6,md:s,children:Object(C.jsx)(g.a,{pb:.5,children:Object(C.jsx)(Me,{style:e.style,children:e.children})})})]})};function Pe(e){var t=e.applicationForm,i=e.headerVariant;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(k.a,{variant:i,children:"Application Details"}),Object(C.jsx)(g.a,{my:2,children:Object(C.jsxs)(v.a,{container:!0,children:[Object(C.jsx)(Te,{title:"Full Name",children:t.fullName}),Object(C.jsx)(Te,{title:"Mobile",children:t.mobileNumber}),Object(C.jsx)(Te,{title:"Other Mobile",children:t.otherMobileNumber}),Object(C.jsx)(Te,{title:"Special Notes",children:t.specialNotes})]})})]})}function Re(e){var t,i=e.worker,a=e.headerVariant;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(k.a,{variant:a,children:"Requested Worker"}),Object(C.jsx)(g.a,{my:2,children:Object(C.jsxs)(v.a,{container:!0,spacing:2,children:[Object(C.jsx)(v.a,{item:!0,xs:4,children:Object(C.jsx)(y.a,{src:"".concat("https://d15f7urgawp38o.cloudfront.net","/").concat("2y/sm","/").concat(i.id,".").concat(i.smallPictureFileExt),style:{width:"100%",minHeight:160,alignSelf:"center"},variant:"rounded"})}),Object(C.jsx)(v.a,{item:!0,xs:8,children:Object(C.jsxs)(v.a,{container:!0,children:[Object(C.jsx)(Te,{title:"Agency",children:null===(t=i.agency)||void 0===t?void 0:t.title}),Object(C.jsx)(Te,{title:"Ref #",children:i.referenceId}),Object(C.jsx)(Te,{title:"Name",children:i.name}),Object(C.jsx)(Te,{title:"Nationality",children:i.nationality}),Object(C.jsx)(Te,{title:"Job Title",children:i.jobTitle}),Object(C.jsxs)(Te,{title:"Salary",children:["BHD ",i.monthlySalary," / Month"]}),Object(C.jsxs)(Te,{title:"Processing Fees",children:["BHD ",i.processFees]}),Object(C.jsxs)(Te,{title:"Contract Period",children:[i.contractPeriod," Years"]})]})})]})})]})}function Ae(e){var t=e.history,i=e.config.statusCodesTwoYear.find((function(e){return e.code===t.statusCode}));return Object(C.jsx)(g.a,{boxShadow:"0 0 9px "+b.primary+"44",my:1,py:1,px:2,borderRadius:16,children:Object(C.jsx)(Me,{children:Object(C.jsxs)(v.a,{container:!0,spacing:1,children:[Object(C.jsx)(v.a,{item:!0,xs:12,md:8,children:Object(C.jsx)(g.a,{color:"cornflowerblue",fontWeight:"bold",children:null===i||void 0===i?void 0:i.title})}),Object(C.jsx)(v.a,{item:!0,xs:12,md:4,children:Object(C.jsx)(g.a,{textAlign:"right",fontStyle:"italic",children:Se()(t.created,"d mmm yyyy, h:MM tt")})}),Object(C.jsx)(v.a,{item:!0,xs:12,md:6,children:t.statusRemarks}),Object(C.jsx)(v.a,{item:!0,xs:12,md:6,children:Object(C.jsx)(g.a,{style:{color:"yellowgreen",textAlign:"right"},fontStyle:"italic",children:t.createdBy})})]})})})}function qe(e){var t=e.formik,i=e.disabled,a=e.request,n=e.dropdownOptions,r=e.config,s=[{name:"statusCode",variant:"select",selectOptions:n},{name:"statusRemarksNew",variant:"textarea"}];return Object(C.jsxs)("form",{onSubmit:t.handleSubmit,children:[Object(C.jsxs)(v.a,{container:!0,spacing:2,children:[Object(C.jsx)(v.a,{item:!0,md:6,xs:12,children:Object(C.jsx)(de,{header:"Agency Actions",fields:s,md:12,formik:t})}),Object(C.jsx)(v.a,{item:!0,md:6,xs:12,children:Object(C.jsx)(de,{header:"History",md:12,children:a.statusHistory.map((function(e){return Object(C.jsx)(Ae,{history:e,config:r},e.created.toString()+e.createdByUserId)}))})})]}),Object(C.jsx)(xe,{title:"Save",type:"submit",disabled:i||t.isSubmitting})]})}function Be(e){var t=Object(a.useState)(!0),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)(null),c=Object(p.a)(s,2),o=c[0],l=c[1],d=null===o||void 0===o?void 0:o.status,u=(null!==o&&void 0!==(null===d||void 0===d?void 0:d.nextCodes)?e.config.statusCodesTwoYear.filter((function(e){return d.nextCodes.includes(e.code)||e.code===o.statusCode})):e.config.statusCodesTwoYear).map((function(e){return{value:e.code,title:e.title,color:e.isReject?"red":0===e.nextCodes.length?"darkgreen":void 0}}));return Object(a.useEffect)((function(){n&&S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/requests/"+e.id,{withCredentials:!0}).then((function(e){r(!1),l(e.data.data)}))}),[n,e.id]),Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(F,{title:"Update Request",children:["Tracking # ",null===o||void 0===o?void 0:o.trackingCode]}),null!==o&&void 0!==o.workerTwoYear&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(g.a,{children:Object(C.jsxs)(v.a,{container:!0,children:[Object(C.jsx)(v.a,{item:!0,xs:12,md:6,children:Object(C.jsx)(Pe,{headerVariant:"h6",applicationForm:o.applicationForm})}),Object(C.jsx)(v.a,{item:!0,xs:12,md:6,children:Object(C.jsx)(Re,{headerVariant:"h6",worker:o.workerTwoYear})})]})}),Object(C.jsx)(g.a,{children:Object(C.jsx)(te.a,{initialValues:o,validationSchema:ie.d({statusCode:ie.c().required("Required")}),onSubmit:function(e,t){var i=t.setSubmitting;S.a.put("https://estreeh-dev-apis.herokuapp.com/api/v1/be/requests",e,{withCredentials:!0}).then((function(e){ae.b.success(e.data.message),i(!1),r(!0)}))},children:function(t){return Object(C.jsx)(qe,{formik:t,request:o,disabled:n,dropdownOptions:u,config:e.config})}})})]})]})}var Ie=i.p+"static/media/check.6b6350a4.svg";function Le(e){return Object(C.jsxs)(g.a,{textAlign:"center",children:[Object(C.jsx)(g.a,{maxWidth:120,mx:"auto",pb:3,children:Object(C.jsx)("img",{src:Ie,style:{display:"block"},alt:"success"})}),Object(C.jsx)(k.a,{variant:"h5",children:"Success!"}),Object(C.jsx)(g.a,{py:1,children:Object(C.jsx)(k.a,{variant:"h6",children:e.bigText})}),Object(C.jsx)(g.a,{children:Object(C.jsx)(k.a,{children:e.smallText})}),Object(C.jsx)(g.a,{p:2,children:Object(C.jsx)(me.a,{variant:"middle"})}),Object(C.jsx)(g.a,{children:e.children})]})}function Ne(e){var t=void 0!==e.navigate?e.navigate:function(e){};return Object(C.jsxs)(Le,{bigText:"New worker added successfully",children:[Object(C.jsx)(_.a,{variant:"contained",color:"primary",style:{marginRight:16},onClick:function(){t("../add")},children:"Add Another"}),Object(C.jsx)(_.a,{variant:"contained",color:"primary",onClick:function(){t("..")},children:"Workers List"})]})}function _e(e){var t=void 0!==e.navigate?e.navigate:function(e){};return Object(C.jsx)(Le,{bigText:"Request updated successfully",children:Object(C.jsx)(_.a,{variant:"contained",color:"primary",onClick:function(){t("..")},children:"Done"})})}var De=i(18),Ee={bahrain:{currencyCode:"BHD",currencySymbol:"BD",currencySymbolAr:"\u062f.\u0628",currencyDecimals:3,fixedProcessFees:{lmraFees:20,vatPercentage:.05,workPermitFees:30}}};function We(e){var t=e.process,i=e.region.currencyCode,a=!e.editing||e.saving,n=[{name:"title",readOnly:a}],r=[{name:"processFeesBhd",readOnly:a,suffix:i,type:"number"},{name:"governmentFeesBhd",readOnly:a,type:"number",suffix:i},{name:"insuranceFeesBhd",readOnly:a,suffix:i,type:"number"},{name:"accommodationFeesBhd",readOnly:a,suffix:i,type:"number"},{name:"otherFeesLabel",defaultValue:t.otherFeesLabel,readOnly:a,variant:"text"},{name:"otherFeesBhd",readOnly:a,suffix:i,type:"number"}],s=[{name:"vatFeesBhd",readOnly:a,suffix:i},{name:"totalFeesBhd",readOnly:!0,suffix:i}],c=[{name:"processDurationMinimumMonths",label:"Minimum",type:"number",readOnly:a,step:.25,suffix:"Months",defaultValue:t.processDurationMinimumMonths>0?t.processDurationMinimumMonths:void 0},{name:"processDurationMaximumMonths",label:"Maximum",type:"number",readOnly:a,suffix:"Months",step:.25,defaultValue:t.processDurationMaximumMonths>0?t.processDurationMaximumMonths:void 0}];return Object(C.jsxs)(g.a,{px:1,children:[Object(C.jsx)(de,{header:"Process Name",fields:n,md:6,headerVariant:"small",formik:e.formik}),Object(C.jsx)(de,{fields:r,md:4,headerVariant:"small",formik:e.formik}),Object(C.jsx)(de,{fields:s,md:4,headerVariant:"small",formik:e.formik}),Object(C.jsx)(de,{header:"Durations",fields:c,md:4,headerVariant:"small",formik:e.formik})]})}function ze(e){var t=Object(a.useState)(e.newItem),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)(!1),c=Object(p.a)(s,2),o=c[0],l=c[1],d=e.process.countAssignedWorkers,u="0.7rem",j=.25;return Object(C.jsx)(g.a,{boxShadow:b.shadow.niceShadow,borderRadius:b.borderRadius.niceRadius,border:n?"2px dashed blue":"1px solid "+b.lighter,p:1,my:1,children:Object(C.jsx)(te.a,{initialValues:e.process,validationSchema:ie.d({title:ie.e().min(3,"Minimum 3 characters").required("Required"),accommodationFeesBhd:ie.c().required("Required"),governmentFeesBhd:ie.c().required("Required"),insuranceFeesBhd:ie.c().required("Required"),otherFeesBhd:ie.c().required("Required"),vatFeesBhd:ie.c().required("Required"),processFeesBhd:ie.c().min(5,"Minimum ".concat(5," BHD")).required("Required"),otherFeesLabel:ie.e().required("Required"),agencyId:ie.e().optional(),countAssignedWorkers:ie.c().optional(),created:ie.b().optional(),modified:ie.b().optional(),processDurationMinimumMonths:ie.c().min(j,"Minimum ".concat(j," Months")).required("Required"),processDurationMaximumMonths:ie.c().min(j,"Minimum ".concat(j," Months")).required("Required"),totalFeesBhd:ie.c().optional(),vatPercentage:ie.c().optional(),_id:ie.e().optional(),id:ie.e().optional()}),onSubmit:function(e,t){var i=t.setSubmitting;i(!0),l(!0);var a=void 0===e._id?"POST":"PUT";S.a.request({method:a,url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/process-templates",data:e,withCredentials:!0}).then((function(e){ae.b.success(e.data.message),r(!1),l(!1),i(!1)})).catch((function(e){ae.b.error(e.message),l(!1),i(!1)}))},children:function(t){return Object(C.jsx)("form",{onSubmit:t.handleSubmit,children:Object(C.jsxs)(v.a,{container:!0,spacing:2,alignItems:"flex-end",children:[Object(C.jsxs)(v.a,{item:!0,md:10,xs:12,children:[Object(C.jsx)(We,{process:e.process,region:e.region,editing:n,saving:o,formik:t})," "]}),Object(C.jsx)(v.a,{item:!0,md:2,xs:12,children:Object(C.jsxs)(g.a,{p:1,children:[Object(C.jsxs)(g.a,{p:1,textAlign:"center",fontSize:u,children:["Assigned Workers: ",d]}),n&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(fe,{errors:t.errors,style:{fontSize:u}}),Object(C.jsx)(g.a,{my:1,textAlign:"center",fontSize:u,color:"blue",fontStyle:"italic",children:0===Object.keys(t.errors).length&&Object(C.jsxs)(C.Fragment,{children:["Please save your changes",d>0?", they will be applied automatically to ".concat(d," workers"):""]})}),Object(C.jsx)(_.a,{fullWidth:!0,color:"primary",variant:"outlined",disabled:o,type:"submit",children:o?"Saving...":"Save"})]}),!n&&Object(C.jsx)(_.a,{fullWidth:!0,variant:"outlined",color:"primary",onClick:function(){r(!0)},children:"Edit"})]})})]})})}})})}function Ue(e){var t=Object(a.useState)([]),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)(!0),c=Object(p.a)(s,2),o=c[0],l=c[1];function d(){console.log("Loading process templates..."),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/process-templates",{withCredentials:!0}).then((function(e){r(e.data.data),console.log("Process templates loaded"),l(!1)}))}return Object(a.useEffect)((function(){o&&d()}),[o]),Object(C.jsxs)(g.a,{children:[Object(C.jsx)(F,{title:"Process Templates"}),Object(C.jsx)(g.a,{children:n.map((function(e,t){return Object(C.jsx)(ze,{process:e,region:Ee.bahrain,newItem:void 0===e._id,loadProcessTemplates:d},e._id)}))}),Object(C.jsx)(g.a,{children:Object(C.jsx)(_.a,{color:"primary",variant:"contained",onClick:function(){r((function(e){return[].concat(Object(De.a)(e),[{accommodationFeesBhd:0,insuranceFeesBhd:0,otherFeesBhd:0,processFeesBhd:0,processDurationMaximumMonths:0,processDurationMinimumMonths:0,vatFeesBhd:0,governmentFeesBhd:0,vatPercentage:0,title:"",agencyId:"",otherFeesLabel:"Others",countAssignedWorkers:0,totalFeesBhd:0,created:new Date,modified:new Date}])}))},children:"+ Add More"})}),Object(C.jsx)(xe,{title:"Exit",navigate:e.navigate,navigateUrl:"/panel/dashboard"})]})}function He(e){return Object(C.jsx)(Y,{title:"401",subtitle:"\u274c Unauthorized",children:Object(C.jsxs)(k.a,{children:["Unauthorized or session has expired. Please make sure you have ",Object(C.jsx)(I.a,{href:"/login",children:"logged in"}),"."]})})}var Ve=i(1912);function Ye(e){var t=Object(a.useState)({}),i=Object(p.a)(t,2),r=i[0],s=i[1],c=Object(a.useState)(!0),o=Object(p.a)(c,2),l=o[0],d=o[1];Object(a.useEffect)((function(){l&&S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency",{withCredentials:!0}).then((function(e){s(e.data.data),d(!1)}))}),[l,d]);var u=[{name:"title",label:"Agency Name (English)",readOnly:!0},{name:"titleAr",label:"Agency Name (Arabic)",readOnly:!0},{name:"cr",readOnly:!0,defaultValue:je.a.datatype.number({min:1e4,max:99999})+"-"+je.a.datatype.number({min:0,max:9})},{name:"telephone"},{name:"mobile"},{name:"email"},{name:"openingTimes",md:12,variant:"textarea",textareaLines:4}],j=[{name:"uploadLogo",variant:"file",buttonIcon:"photo_camera"}],h=[{name:"Local Transfer Worker Terms & Conditions",variant:"textarea",textareaLines:11}],b=(g.a,be.a,pe.map((function(e){return Object(C.jsx)(K.a,{control:Object(C.jsx)(X.a,{name:"nationality_"+e,color:"primary"}),label:e},e)})),Object(C.jsx)(g.a,{my:4,children:Object(C.jsx)(me.a,{})}));function m(t){t(!1),e.navigate&&e.navigate("success")}return Object(C.jsx)(C.Fragment,{children:!l&&Object(C.jsx)(te.a,{initialValues:r,validationSchema:ie.d({}),onSubmit:function(e,t){var i=t.setSubmitting;i(!0);S.a.request({method:"PUT",url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency",data:e,withCredentials:!0}).then((function(t){ae.b.success(t.data.message),void 0!==e.uploadLogo?function(e,t){var i=new FormData;i.append("file",e),S.a.request({method:"PUT",url:"https://estreeh-dev-apis.herokuapp.com/api/v1/be/agency/picture",data:i,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){ae.b.success(e.data.message),m(t)}))}(e.uploadLogo,i):m(i)})).catch((function(e){ae.b.error(e.message),i(!1)}))},children:function(e){return Object(C.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(C.jsxs)(n.a.Fragment,{children:[Object(C.jsx)(F,{title:"Agency Settings"}),Object(C.jsx)(de,{header:"Agency Profile",fields:u,md:6,formik:e}),Object(C.jsx)(de,{header:"Images",xs:12,children:Object(C.jsx)(v.a,{container:!0,children:Object(C.jsx)(v.a,{item:!0,xs:4,children:Object(C.jsx)(y.a,{src:"https://d15f7urgawp38o.cloudfront.net/agency/sm/"+r._id+"."+r.logoFileExt,variant:"rounded",style:{width:160,height:160}})})})}),Object(C.jsx)(de,{xs:12,fields:j,formik:e})]}),b,Object(C.jsxs)(C.Fragment,{children:[!1,Object(C.jsx)(F,{title:"Terms & Conditions"}),Object(C.jsx)(de,{fields:h,md:12,formik:e})]}),b,Object(C.jsxs)(n.a.Fragment,{children:[Object(C.jsx)(F,{title:"Payment Methods"}),Object(C.jsx)(g.a,{children:Object(C.jsx)(Ve.a,{severity:"info",children:"Currently only Cash option is available. More options will be available in near future."})}),Object(C.jsx)(xe,{errors:e.errors,type:"submit",title:"save",disabled:e.isSubmitting})]})]})}})})}function Ge(e){var t=void 0!==e.navigate?e.navigate:function(e){};return Object(C.jsx)(Le,{bigText:"Agency settings updated successfully",smallText:"If you have updated the logo, it might take up to 60 seconds to appear.",children:Object(C.jsx)(_.a,{variant:"contained",color:"primary",onClick:function(){t("/panel/dashboard")},children:"Done"})})}function Je(e){var t=Object(a.useState)(!0),i=Object(p.a)(t,2),n=i[0],r=i[1],s=Object(a.useState)(void 0),c=Object(p.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)(),u=Object(p.a)(d,2),j=u[0],h=u[1],b=function(){return S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/auth/me",{withCredentials:!0})};Object(a.useEffect)((function(){n&&(console.log("Getting user"),b().then((function(e){console.log("User received from API");var t=e.data.data;l(t),S.a.get("https://estreeh-dev-apis.herokuapp.com/api/v1/pub/config",{withCredentials:!0}).then((function(e){h(e.data.data),r(!1)}))})))}),[l,r,n]);var m=void 0!==o&&void 0!==o.agencyId&&["Agency","Agency Manager"].includes(o.role);return n?Object(C.jsx)(g.a,{p:2,textAlign:"center",children:Object(C.jsx)(k.a,{variant:"h6",children:"Loading..."})}):Object(C.jsxs)(O.c,{primary:!1,children:[Object(C.jsx)(O.b,{from:"/",to:m?"/panel":"/login",noThrow:!0}),!m&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(He,{default:!0}),Object(C.jsx)(V,{path:"login",children:Object(C.jsx)(Q,{setUser:l,path:"/",getUser:b})})]}),m&&void 0!==o&&void 0!==o.agencyId&&void 0!==j&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(G,{default:!0}),Object(C.jsxs)(E,{path:"panel",user:o,setUser:l,children:[Object(C.jsx)(O.b,{from:"/",to:"dashboard",noThrow:!0}),Object(C.jsx)(P,{path:"dashboard",user:o}),Object(C.jsxs)(W,{path:"my-workers",children:[Object(C.jsx)(Fe,{path:"/"}),Object(C.jsx)(ge,{path:"add"}),Object(C.jsx)(ge,{path:"edit/:id"}),Object(C.jsx)(Ne,{path:"success"})]}),Object(C.jsxs)(W,{path:"my-requests",children:[Object(C.jsx)(Ce,{path:"/",config:j}),Object(C.jsx)(Be,{path:"update/:id",config:j}),Object(C.jsx)(_e,{path:"success"})]}),Object(C.jsxs)(W,{path:"agency/settings",children:[Object(C.jsx)(Ye,{default:!0}),Object(C.jsx)(Ue,{path:"process-templates"}),Object(C.jsx)(Ge,{path:"success"})]})]})]})]})}i(1854);function Ke(e){var t=m(),i="ltr";return document.documentElement.dir=i,document.documentElement.lang="en",document.body.dir=i,document.body.lang="en",Object(C.jsxs)(c.a,{theme:x,children:[Object(C.jsx)(ae.a,{}),Object(C.jsx)("div",{className:t.root,id:"after-root",dir:i,style:{height:"100%",fontFamily:b.fontFamily.body},children:Object(C.jsx)(Je,{})})]})}i(1855);var Xe=function(){return Object(C.jsx)(Ke,{useRtl:!1})},Qe=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,1916)).then((function(t){var i=t.getCLS,a=t.getFID,n=t.getFCP,r=t.getLCP,s=t.getTTFB;i(e),a(e),n(e),r(e),s(e)}))};s.a.render(Object(C.jsx)(n.a.StrictMode,{children:Object(C.jsx)(Xe,{})}),document.getElementById("root")),Qe()},236:function(e,t,i){}},[[1856,1,2]]]);
//# sourceMappingURL=main.36fb5f67.chunk.js.map